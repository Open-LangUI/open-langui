{"version":3,"file":"database-DPmGJg9n.js","sources":["../../../.svelte-kit/adapter-node/chunks/database.js"],"sourcesContent":["import { DatabaseSync } from \"node:sqlite\";\nimport { mkdirSync } from \"node:fs\";\nimport { join } from \"node:path\";\nconst dbPath = join(process.cwd(), \"data\", \"languages.db\");\nmkdirSync(join(process.cwd(), \"data\"), { recursive: true });\nconst db = new DatabaseSync(dbPath);\ndb.exec(`CREATE TABLE IF NOT EXISTS languages (\n  code TEXT PRIMARY KEY,\n  name TEXT NOT NULL,\n  romanize INTEGER NOT NULL DEFAULT 0,\n  prompt TEXT NOT NULL DEFAULT ''\n);`);\ndb.exec(`CREATE TABLE IF NOT EXISTS lang_db (\n  code TEXT PRIMARY KEY,\n  name TEXT NOT NULL,\n  romanize INTEGER NOT NULL DEFAULT 0,\n  prompt TEXT NOT NULL DEFAULT ''\n);`);\ndb.exec(`CREATE TABLE IF NOT EXISTS connections (\n  id INTEGER PRIMARY KEY CHECK (id = 1),\n  base_url TEXT NOT NULL,\n  api_key TEXT DEFAULT '',\n  temperature REAL NOT NULL DEFAULT 0.2\n);`);\nconst seedLanguages = [\n  { name: \"Auto\", code: \"auto\", romanize: false, prompt: \"\" },\n  { name: \"English\", code: \"en\", romanize: false, prompt: \"Return phonetic sounds in KK system.\" },\n  { name: \"Chinese (Simplified)\", code: \"zh-CN\", romanize: true, prompt: \"Return romanization in pinyin.\" },\n  { name: \"Chinese (Traditional)\", code: \"zh-TW\", romanize: true, prompt: \"Return romanization in pinyin.\" },\n  { name: \"Japanese\", code: \"ja\", romanize: true, prompt: \"Return romanization in romaji.\" },\n  { name: \"Spanish\", code: \"es\", romanize: false, prompt: \"\" },\n  { name: \"French\", code: \"fr\", romanize: false, prompt: \"\" },\n  { name: \"Korean\", code: \"ko\", romanize: true, prompt: \"Return romanization in Revised Romanization.\" }\n];\nconst countStmt = db.prepare(\"SELECT COUNT(*) AS count FROM languages\");\nconst row = countStmt.get();\nconst insertLanguage = db.prepare(\n  \"INSERT OR IGNORE INTO languages (code, name, romanize, prompt) VALUES (?, ?, ?, ?)\"\n);\nconst insertLibraryLanguage = db.prepare(\n  \"INSERT OR IGNORE INTO lang_db (code, name, romanize, prompt) VALUES (?, ?, ?, ?)\"\n);\nif (!row || row.count === 0) {\n  for (const lang of seedLanguages) {\n    insertLanguage.run(lang.code, lang.name, lang.romanize ? 1 : 0, lang.prompt);\n  }\n}\nconst libraryCount = db.prepare(\"SELECT COUNT(*) AS count FROM lang_db\").get();\nif (!libraryCount || libraryCount.count === 0) {\n  for (const lang of seedLanguages) {\n    insertLibraryLanguage.run(lang.code, lang.name, lang.romanize ? 1 : 0, lang.prompt);\n  }\n}\nconst connectionCount = db.prepare(\"SELECT COUNT(*) AS count FROM connections\").get();\nif (!connectionCount || connectionCount.count === 0) {\n  db.prepare(\"INSERT INTO connections (id, base_url, api_key, temperature) VALUES (1, ?, ?, ?)\").run(\n    \"http://localhost:1234\",\n    \"\",\n    0.2\n  );\n}\nconst DEFAULT_SOURCE = \"auto\";\nconst DEFAULT_TARGET = \"zh-TW\";\nexport {\n  DEFAULT_TARGET as D,\n  DEFAULT_SOURCE as a,\n  db as d\n};\n"],"names":[],"mappings":"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"}