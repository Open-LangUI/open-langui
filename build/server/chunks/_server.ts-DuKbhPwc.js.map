{"version":3,"file":"_server.ts-DuKbhPwc.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/languages/_code_/_server.ts.js"],"sourcesContent":["import { json } from \"@sveltejs/kit\";\nimport { d as db } from \"../../../../../chunks/database.js\";\nconst PUT = async ({ params, request }) => {\n  const originalCode = params.code;\n  if (!originalCode) {\n    return json({ error: \"Language code is required.\" }, { status: 400 });\n  }\n  let payload;\n  try {\n    payload = await request.json();\n  } catch {\n    return json({ error: \"Invalid JSON payload.\" }, { status: 400 });\n  }\n  const name = typeof payload.name === \"string\" ? payload.name.trim() : \"\";\n  const code = typeof payload.code === \"string\" ? payload.code.trim() : \"\";\n  const prompt = typeof payload.prompt === \"string\" ? payload.prompt : \"\";\n  const romanize = Boolean(payload.romanize);\n  if (!name || !code) {\n    return json({ error: \"Name and code are required.\" }, { status: 400 });\n  }\n  try {\n    const stmt = db.prepare(\n      \"UPDATE languages SET code = ?, name = ?, romanize = ?, prompt = ? WHERE code = ?\"\n    );\n    const result = stmt.run(code, name, romanize ? 1 : 0, prompt, originalCode);\n    if (result.changes === 0) {\n      return json({ error: \"Language not found.\" }, { status: 404 });\n    }\n    return json({ success: true });\n  } catch (error) {\n    if (error?.code === \"SQLITE_CONSTRAINT_PRIMARYKEY\") {\n      return json({ error: \"A language with that code already exists.\" }, { status: 400 });\n    }\n    console.error(\"Failed to update language:\", error);\n    return json({ error: \"Failed to update language.\" }, { status: 500 });\n  }\n};\nconst DELETE = async ({ params }) => {\n  const code = params.code;\n  if (!code) return json({ error: \"Language code is required.\" }, { status: 400 });\n  try {\n    if (code === \"auto\") return json({ error: \"Cannot delete auto language.\" }, { status: 400 });\n    const stmt = db.prepare(\"DELETE FROM languages WHERE code = ?\");\n    const result = stmt.run(code);\n    if (result.changes === 0) return json({ error: \"Language not found.\" }, { status: 404 });\n    return json({ success: true });\n  } catch (e) {\n    console.error(\"Failed to delete language\", e);\n    return json({ error: \"Failed to delete language.\" }, { status: 500 });\n  }\n};\nexport {\n  DELETE,\n  PUT\n};\n"],"names":[],"mappings":"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"}