import"../chunks/DsnmJJEf.js";import{i as _t}from"../chunks/CZYVMSbA.js";import{a as wa,o as Ht,b as Jt,e as O,s as ne,c as Vt}from"../chunks/DcF3xoQD.js";import{h as Xe,D as ra,C as ya,i as e,a3 as na,F as za,H as ka,G as Wt,I as Ot,J as It,S as zt,af as La,aJ as Ea,M as Pt,P as Ta,O as ht,aF as oa,ay as ia,K as sa,aW as _,ac as $t,ae as Gt,Q as la,R as Ca,a_ as St,a$ as jt,an as ca,b0 as At,b1 as Sa,at as Aa,b2 as Ma,aE as Na,b3 as Oa,a1 as da,aA as Ia,b4 as ua,W as va,b5 as ja,E as Da,b6 as Ra,b7 as Ba,T as Pa,e as G,b8 as Fa,aw as fa,b9 as Ua,w as kt,ba as Ka,aV as Ha,V as Ja,bb as Va,x as wt,bc as Se,bd as Mt,t as T,o as ze,v as Q,p as b,y as yt,j as oe,a0 as t,be as pa,B as f,z as i,A as o,ao as qt,bf as Lt,m as $e,bg as ga,bh as Ft,n as qa}from"../chunks/DJ8JGTRo.js";import{p as pe,i as R,b as pt}from"../chunks/F2tdbd6K.js";import{s as it,r as ot,a as Wa}from"../chunks/DspkWKzF.js";import{i as Zt}from"../chunks/YZs77HQT.js";function mt(n,a){return a}function $a(n,a,r){for(var l=n.items,s=[],w=a.length,p=0;p<w;p++)Ma(a[p].e,s,!0);var d=w>0&&s.length===0&&r!==null;if(d){var L=r.parentNode;Na(L),L.append(r),l.clear(),nt(n,a[0].prev,a[w-1].next)}Oa(s,()=>{for(var x=0;x<w;x++){var g=a[x];d||(l.delete(g.k),nt(n,g.prev,g.next)),ca(g.e,!d)}})}function ut(n,a,r,l,s,w=null){var p=n,d={flags:a,items:new Map,first:null},L=(a&ua)!==0;if(L){var x=n;p=Xe?Ot(Ia(x)):x.appendChild(sa())}Xe&&ra();var g=null,B=!1,H=new Map,D=na(()=>{var S=r();return ia(S)?S:S==null?[]:oa(S)}),y,u;function E(){Ga(u,y,d,H,p,s,a,l,r),w!==null&&(y.length===0?g?la(g):g=Pt(()=>w(p)):g!==null&&Ca(g,()=>{g=null}))}ya(()=>{u??=da,y=e(D);var S=y.length;if(B&&S===0)return;B=S===0;let k=!1;if(Xe){var U=za(p)===ka;U!==(S===0)&&(p=Wt(),Ot(p),It(!1),k=!0)}if(Xe){for(var W=null,j,v=0;v<S;v++){if(zt.nodeType===La&&zt.data===Ea){p=zt,k=!0,It(!1);break}var M=y[v],F=l(M,v);j=Ut(zt,d,W,null,M,F,v,s,a,r),d.items.set(F,j),W=j}S>0&&Ot(Wt())}if(Xe)S===0&&w&&(g=Pt(()=>w(p)));else if(Ta()){var X=new Set,Ae=ht;for(v=0;v<S;v+=1){M=y[v],F=l(M,v);var ae=d.items.get(F)??H.get(F);ae?(a&(At|St))!==0&&ma(ae,M,v,a):(j=Ut(null,d,null,null,M,F,v,s,a,r,!0),H.set(F,j)),X.add(F)}for(const[J,P]of d.items)X.has(J)||Ae.skipped_effects.add(P.e);Ae.add_callback(E)}else E();k&&It(!0),e(D)}),Xe&&(p=zt)}function Ga(n,a,r,l,s,w,p,d,L){var x=(p&ja)!==0,g=(p&(At|St))!==0,B=a.length,H=r.items,D=r.first,y=D,u,E=null,S,k=[],U=[],W,j,v,M;if(x)for(M=0;M<B;M+=1)W=a[M],j=d(W,M),v=H.get(j),v!==void 0&&(v.a?.measure(),(S??=new Set).add(v));for(M=0;M<B;M+=1){if(W=a[M],j=d(W,M),v=H.get(j),v===void 0){var F=l.get(j);if(F!==void 0){l.delete(j),H.set(j,F);var X=E?E.next:y;nt(r,E,F),nt(r,F,X),Dt(F,X,s),E=F}else{var Ae=y?y.e.nodes_start:s;E=Ut(Ae,r,E,E===null?r.first:E.next,W,j,M,w,p,L)}H.set(j,E),k=[],U=[],y=E.next;continue}if(g&&ma(v,W,M,p),(v.e.f&jt)!==0&&(la(v.e),x&&(v.a?.unfix(),(S??=new Set).delete(v))),v!==y){if(u!==void 0&&u.has(v)){if(k.length<U.length){var ae=U[0],J;E=ae.prev;var P=k[0],le=k[k.length-1];for(J=0;J<k.length;J+=1)Dt(k[J],ae,s);for(J=0;J<U.length;J+=1)u.delete(U[J]);nt(r,P.prev,le.next),nt(r,E,P),nt(r,le,ae),y=ae,E=le,M-=1,k=[],U=[]}else u.delete(v),Dt(v,y,s),nt(r,v.prev,v.next),nt(r,v,E===null?r.first:E.next),nt(r,E,v),E=v;continue}for(k=[],U=[];y!==null&&y.k!==j;)(y.e.f&jt)===0&&(u??=new Set).add(y),U.push(y),y=y.next;if(y===null)continue;v=y}k.push(v),E=v,y=v.next}if(y!==null||u!==void 0){for(var ge=u===void 0?[]:oa(u);y!==null;)(y.e.f&jt)===0&&ge.push(y),y=y.next;var be=ge.length;if(be>0){var fe=(p&ua)!==0&&B===0?s:null;if(x){for(M=0;M<be;M+=1)ge[M].a?.measure();for(M=0;M<be;M+=1)ge[M].a?.fix()}$a(r,ge,fe)}}x&&va(()=>{if(S!==void 0)for(v of S)v.a?.apply()}),n.first=r.first&&r.first.e,n.last=E&&E.e;for(var re of l.values())ca(re.e);l.clear()}function ma(n,a,r,l){(l&At)!==0&&Gt(n.v,a),(l&St)!==0?Gt(n.i,r):n.i=r}function Ut(n,a,r,l,s,w,p,d,L,x,g){var B=(L&At)!==0,H=(L&Sa)===0,D=B?H?_(s,!1,!1):$t(s):s,y=(L&St)===0?p:$t(p),u={i:y,v:D,k:w,a:null,e:null,prev:r,next:l};try{if(n===null){var E=document.createDocumentFragment();E.append(n=sa())}return u.e=Pt(()=>d(n,D,y,x),Xe),u.e.prev=r&&r.e,u.e.next=l&&l.e,r===null?g||(a.first=u):(r.next=u,r.e.next=u.e),l!==null&&(l.prev=u,l.e.prev=u.e),u}finally{}}function Dt(n,a,r){for(var l=n.next?n.next.e.nodes_start:r,s=a?a.e.nodes_start:r,w=n.e.nodes_start;w!==null&&w!==l;){var p=Aa(w);s.before(w),w=p}}function nt(n,a,r){a===null?n.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function Za(n,a,r,l,s){Xe&&ra();var w=a.$$slots?.[r],p=!1;w===!0&&(w=a.children,p=!0),w===void 0?s!==null&&s(n):w(n,p?()=>l:l)}function ba(n){var a,r,l="";if(typeof n=="string"||typeof n=="number")l+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(a=0;a<s;a++)n[a]&&(r=ba(n[a]))&&(l&&(l+=" "),l+=r)}else for(r in n)n[r]&&(l&&(l+=" "),l+=r);return l}function Ya(){for(var n,a,r=0,l="",s=arguments.length;r<s;r++)(n=arguments[r])&&(a=ba(n))&&(l&&(l+=" "),l+=a);return l}function Yt(n){return typeof n=="object"?Ya(n):n??""}function Qa(n,a,r){var l=n==null?"":""+n;return l===""?null:l}function Je(n,a,r,l,s,w){var p=n.__className;if(Xe||p!==r||p===void 0){var d=Qa(r);(!Xe||d!==n.getAttribute("class"))&&(d==null?n.removeAttribute("class"):a?n.className=d:n.setAttribute("class",d)),n.__className=r}return w}const Xa=()=>performance.now(),dt={tick:n=>requestAnimationFrame(n),now:()=>Xa(),tasks:new Set};function xa(){const n=dt.now();dt.tasks.forEach(a=>{a.c(n)||(dt.tasks.delete(a),a.f())}),dt.tasks.size!==0&&dt.tick(xa)}function er(n){let a;return dt.tasks.size===0&&dt.tick(xa),{promise:new Promise(r=>{dt.tasks.add(a={c:n,f:r})}),abort(){dt.tasks.delete(a)}}}function Ct(n,a){fa(()=>{n.dispatchEvent(new CustomEvent(a))})}function tr(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const a=n.split("-");return a.length===1?a[0]:a[0]+a.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function Qt(n){const a={},r=n.split(";");for(const l of r){const[s,w]=l.split(":");if(!s||w===void 0)break;const p=tr(s.trim());a[p]=w.trim()}return a}const ar=n=>n;function Xt(n,a,r,l){var s=(n&Fa)!==0,w="both",p,d=a.inert,L=a.style.overflow,x,g;function B(){return fa(()=>p??=r()(a,l?.()??{},{direction:w}))}var H={is_global:s,in(){a.inert=d,Ct(a,"introstart"),x=Kt(a,B(),g,1,()=>{Ct(a,"introend"),x?.abort(),x=p=void 0,a.style.overflow=L})},out(E){a.inert=!0,Ct(a,"outrostart"),g=Kt(a,B(),x,0,()=>{Ct(a,"outroend"),E?.()})},stop:()=>{x?.abort(),g?.abort()}},D=da;if((D.transitions??=[]).push(H),wa){var y=s;if(!y){for(var u=D.parent;u&&(u.f&Da)!==0;)for(;(u=u.parent)&&(u.f&Ra)===0;);y=!u||(u.f&Ba)!==0}y&&Pa(()=>{G(()=>H.in())})}}function Kt(n,a,r,l,s){var w=l===1;if(Ua(a)){var p,d=!1;return va(()=>{if(!d){var E=a({direction:w?"in":"out"});p=Kt(n,E,r,l,s)}}),{abort:()=>{d=!0,p?.abort()},deactivate:()=>p.deactivate(),reset:()=>p.reset(),t:()=>p.t()}}if(r?.deactivate(),!a?.duration)return s(),{abort:kt,deactivate:kt,reset:kt,t:()=>l};const{delay:L=0,css:x,tick:g,easing:B=ar}=a;var H=[];if(w&&r===void 0&&(g&&g(0,1),x)){var D=Qt(x(0,1));H.push(D,D)}var y=()=>1-l,u=n.animate(H,{duration:L,fill:"forwards"});return u.onfinish=()=>{u.cancel();var E=r?.t()??1-l;r?.abort();var S=l-E,k=a.duration*Math.abs(S),U=[];if(k>0){var W=!1;if(x)for(var j=Math.ceil(k/16.666666666666668),v=0;v<=j;v+=1){var M=E+S*B(v/j),F=Qt(x(M,1-M));U.push(F),W||=F.overflow==="hidden"}W&&(n.style.overflow="hidden"),y=()=>{var X=u.currentTime;return E+S*B(X/k)},g&&er(()=>{if(u.playState!=="running")return!1;var X=y();return g(X,1-X),!0})}u=n.animate(U,{duration:k,fill:"forwards"}),u.onfinish=()=>{y=()=>l,g?.(l,1-l),s()}},{abort:()=>{u&&(u.cancel(),u.effect=null,u.onfinish=kt)},deactivate:()=>{s=kt},reset:()=>{l===0&&g?.(1,0)},t:()=>y()}}function We(n,a,r=a){var l=new WeakSet;Ka(n,"input",async s=>{var w=s?n.defaultValue:n.value;if(w=Rt(n)?Bt(w):w,r(w),ht!==null&&l.add(ht),await Ha(),w!==(w=a())){var p=n.selectionStart,d=n.selectionEnd;n.value=w??"",d!==null&&(n.selectionStart=p,n.selectionEnd=Math.min(d,n.value.length))}}),(Xe&&n.defaultValue!==n.value||G(a)==null&&n.value)&&(r(Rt(n)?Bt(n.value):n.value),ht!==null&&l.add(ht)),Ja(()=>{var s=a();if(n===document.activeElement){var w=Va??ht;if(l.has(w))return}Rt(n)&&s===Bt(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Rt(n){var a=n.type;return a==="number"||a==="range"}function Bt(n){return n===""?null:+n}function ea(n){return function(...a){var r=a[0];return r.stopPropagation(),n?.apply(this,a)}}function rr(n,a){var r=n.$$events?.[a.type],l=ia(r)?r.slice():r==null?[]:[r];for(var s of l)s.call(this,a)}const nr=n=>n;function ta(n,{delay:a=0,duration:r=400,easing:l=nr}={}){const s=+getComputedStyle(n).opacity;return{delay:a,duration:r,easing:l,css:w=>`opacity: ${w*s}`}}var or=T('<div class="fixed inset-0 bg-black/40 z-[900]" role="button" tabindex="0" aria-label="Close model selection"></div>'),ir=T('<div class="px-3 py-2 text-sm text-zinc-400">No matches</div>'),sr=T('<button type="button" role="option"> </button>'),lr=T('<div class="absolute left-0 right-0 mt-1 bg-zinc-800 border border-none rounded shadow-lg z-[960] max-h-60 flex flex-col" id="model-select-menu"><div class="p-2"><div class="flex items-center gap-2 bg-zinc-850 border-none border-zinc-700 px-2 py-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" aria-hidden="true" class="w-4 h-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg> <input type="text" class="w-full bg-transparent border-none text-sm text-zinc-100 focus:outline-none" placeholder="Search models…"/></div></div> <div class="max-h-48 overflow-auto px-4 pb-1" role="listbox" tabindex="-1"><!></div></div>'),cr=T('<p class="p-4 text-sm text-zinc-400">No matches</p>'),dr=ga('<svg class="w-4 h-4 text-zinc-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M16.704 5.29a1 1 0 010 1.42l-7.5 7.5a1 1 0 01-1.414 0l-3.5-3.5a1 1 0 011.414-1.42L8.5 11.086l6.793-6.794a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>'),ur=T('<li><button type="button"><span class="truncate"> </span> <!></button></li>'),vr=T('<ul class="divide-y divide-zinc-900"></ul>'),fr=T('<div class="fixed inset-0 z-[960] bg-black/70 backdrop-blur-sm flex flex-col" role="dialog" aria-modal="true"><div class="mt-8 p-4 bg-zinc-900 border-b border-zinc-800 space-y-3 shadow-lg"><div class="flex items-center justify-between"><h2 class="text-sm font-medium text-zinc-100">Select Model</h2> <button type="button" class="px-3 py-2 rounded bg-zinc-800 hover:bg-zinc-700 text-sm text-zinc-200">Close</button></div> <div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" aria-hidden="true" class="w-4 h-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg> <input type="text" class="flex-1 bg-zinc-800 border border-zinc-700 rounded px-3 py-2 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-zinc-500/40" placeholder="Search models…"/></div></div> <div class="flex-1 overflow-auto bg-zinc-950"><!></div></div>'),pr=T('<!> <div class="flex items-center gap-3 w-full sm:w-full sm:max-w-[50vw] relative z-[950]"><div class="relative flex-1 min-w-0"><button type="button" class="flex w-full items-center gap-2 text-lg text-zinc-100 focus:outline-none bg-transparent border-0 p-0 cursor-pointer" aria-haspopup="listbox" aria-controls="model-select-menu"><span> </span> <svg class="w-5 h-5 text-zinc-400 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button> <!></div></div> <!>',1);function gr(n,a){wt(a,!1);let r=pe(a,"model",12,""),l=pe(a,"models",24,()=>[]),s=pe(a,"modelsLoading",8,!1),w=pe(a,"modelsError",8,""),p=pe(a,"onModelChange",8,()=>{}),d=_(!1),L=_(-1),x=_(null),g=_(null),B=_(null);const H=32;let D=_(""),y=_(""),u=_([]),E=_(""),S=_(!1),k=null,U=null;function W(){s()||l().length===0||(t(d,!e(d)),e(d)&&M())}function j(){t(d,!1),t(L,-1)}function v(h){if(!h||h===r()){j();return}r(h),p()(h),j()}function M(){if(!e(u).length){t(L,-1);return}const h=e(u).indexOf(r());t(L,h===-1?0:h),ae(!0),queueMicrotask(()=>e(B)&&e(B).focus())}function F(h){l().length&&(h.key==="Enter"||h.key===" "?(h.preventDefault(),W()):h.key==="ArrowDown"||h.key==="ArrowUp"?(h.preventDefault(),e(d)?Ae(h.key==="ArrowDown"?1:-1):(t(d,!0),t(L,h.key==="ArrowDown"?0:e(u).length-1),ae(!0))):h.key==="Escape"&&j())}function X(h){h.key==="ArrowDown"||h.key==="ArrowUp"?(h.preventDefault(),Ae(h.key==="ArrowDown"?1:-1)):h.key==="Enter"||h.key===" "?(h.preventDefault(),e(L)!==-1&&v(e(u)[e(L)])):h.key==="Escape"&&(h.preventDefault(),j())}function Ae(h){e(u).length&&(t(L,(e(L)+h+e(u).length)%e(u).length),ae())}function ae(h=!1){if(!e(x)||e(L)<0)return;const ie=e(L)*H,me=ie+H,Le=e(x).scrollTop,xe=Le+e(x).clientHeight;h||ie<Le?Lt(x,e(x).scrollTop=ie):me>xe&&Lt(x,e(x).scrollTop=me-e(x).clientHeight)}function J(h){if(e(S)||!e(g))return;const ie=h.target;(!(ie instanceof Node)||!e(g).contains(ie))&&j()}function P(h){(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),j())}function le(h){e(d)&&h.key==="Escape"&&j()}function ge(h){t(S,h.matches)}Ht(()=>{typeof document>"u"||(document.addEventListener("mousedown",J),document.addEventListener("focusin",J),typeof window<"u"&&typeof window.matchMedia=="function"&&(k=window.matchMedia("(max-width: 640px)"),ge(k),U=h=>ge(h),typeof k.addEventListener=="function"?k.addEventListener("change",U):typeof k.addListener=="function"&&k.addListener(U)))}),Jt(()=>{typeof document>"u"||(document.removeEventListener("mousedown",J),document.removeEventListener("focusin",J),k&&U&&(typeof k.removeEventListener=="function"?k.removeEventListener("change",U):typeof k.removeListener=="function"&&k.removeListener(U)))});function be(h){const ie=h.target;t(D,ie instanceof HTMLInputElement?ie.value:""),t(L,e(u).length?0:-1),ae(!0)}Se(()=>(oe(s()),oe(r()),oe(l()),oe(w())),()=>{t(y,s()?"Loading models…":r()||l()[0]||w()||"No models available")}),Se(()=>e(d),()=>{e(d)||t(D,"")}),Se(()=>(e(D),oe(l())),()=>{t(u,e(D)?l().filter(h=>h.toLowerCase().includes(e(D).toLowerCase())):l())}),Se(()=>e(y),()=>{t(E,e(y).length>20?`${e(y).slice(0,19)}…`:e(y))}),Mt(),_t();var fe=pr();O("keydown",pa,le);var re=ze(fe);{var Fe=h=>{var ie=or();O("click",ie,j),O("keydown",ie,P),Xt(3,ie,()=>ta,()=>({duration:150})),b(h,ie)};R(re,h=>{e(d)&&!e(S)&&h(Fe)})}var Me=f(re,2),Ne=i(Me),ke=i(Ne),Ue=i(ke),et=i(Ue,!0);o(Ue),qt(2),o(ke);var Ve=f(ke,2);{var st=h=>{var ie=lr(),me=i(ie),Le=i(me),xe=f(i(Le),2);ot(xe),pt(xe,Oe=>t(B,Oe),()=>e(B)),o(Le),o(me);var Be=f(me,2),Ge=i(Be);{var at=Oe=>{var rt=ir();b(Oe,rt)},vt=Oe=>{var rt=$e(),m=ze(rt);ut(m,1,()=>e(u),mt,(A,K,ce)=>{var Y=sr(),c=i(Y,!0);o(Y),Q(()=>{Je(Y,1,`w-full text-left px-3 py-2 text-sm bg-transparent border-0 cursor-pointer rounded-md transition-colors ${e(L)===ce?"bg-zinc-700 text-white":"text-zinc-100 hover:bg-zinc-800/80 hover:text-white"}`),it(Y,"aria-selected",r()===e(K)),ne(c,e(K))}),O("mouseenter",Y,()=>t(L,ce)),O("click",Y,()=>v(e(K))),b(A,Y)}),b(Oe,rt)};R(Ge,Oe=>{e(u),G(()=>e(u).length===0)?Oe(at):Oe(vt,!1)})}o(Be),pt(Be,Oe=>t(x,Oe),()=>e(x)),o(ie),Q(()=>Wa(xe,e(D))),O("input",xe,be),O("keydown",Be,X),Xt(3,ie,()=>ta,()=>({duration:120})),b(h,ie)};R(Ve,h=>{e(d)&&!e(S)&&h(st)})}o(Ne),o(Me),pt(Me,h=>t(g,h),()=>e(g));var tt=f(Me,2);{var lt=h=>{var ie=fr(),me=i(ie),Le=i(me),xe=f(i(Le),2);o(Le);var Be=f(Le,2),Ge=f(i(Be),2);ot(Ge),pt(Ge,m=>t(B,m),()=>e(B)),o(Be),o(me);var at=f(me,2),vt=i(at);{var Oe=m=>{var A=cr();b(m,A)},rt=m=>{var A=vr();ut(A,5,()=>e(u),mt,(K,ce,Y)=>{var c=ur(),z=i(c),N=i(z),C=i(N,!0);o(N);var q=f(N,2);{var V=ee=>{var he=dr();b(ee,he)};R(q,ee=>{r()===e(ce)&&ee(V)})}o(z),o(c),Q(()=>{Je(z,1,`w-full px-4 py-3 text-left text-sm flex items-center justify-between ${e(L)===Y?"bg-zinc-700 text-white":"text-zinc-200 hover:bg-zinc-900"}`),ne(C,e(ce))}),O("mouseenter",z,()=>t(L,Y)),O("click",z,()=>v(e(ce))),b(K,c)}),o(A),b(m,A)};R(vt,m=>{e(u),G(()=>e(u).length===0)?m(Oe):m(rt,!1)})}o(at),pt(at,m=>t(x,m),()=>e(x)),o(ie),O("click",xe,j),We(Ge,()=>e(D),m=>t(D,m)),b(h,ie)};R(tt,h=>{e(d)&&e(S)&&h(lt)})}Q(()=>{it(ke,"aria-expanded",e(d)),ke.disabled=(oe(s()),oe(l()),oe(w()),G(()=>s()||!l().length&&!w())),Je(Ue,1,`truncate ${w()?"text-red-300":""}`),ne(et,e(E))}),O("click",ke,W),O("keydown",ke,F),b(n,fe),yt()}var mr=T('<header class="sticky top-0 bg-zinc-900 p-4 flex flex-wrap items-center justify-between gap-4 z-[1000]"><div class="flex items-center gap-3 flex-1 min-w-0"><a href="/" class="flex items-center group" aria-label="OpenLang home"><img src="/images/openlang.svg" alt="OpenLang" class="h-7 w-auto group-hover:animate-tilt-shake"/></a> <!></div> <button type="button" class="px-2 py-2 bg-transparent rotate-90 rounded-lg flex items-center gap-2 transition-colors hover:bg-zinc-600/60"><img src="/images/preferences.svg" alt="Open Preferences" class="h-6 w-auto"/></button></header>');function br(n,a){wt(a,!1);let r=pe(a,"model",12,""),l=pe(a,"models",24,()=>[]),s=pe(a,"modelsLoading",8,!1),w=pe(a,"modelsError",8,""),p=pe(a,"onModelChange",8,()=>{});const d=Vt();function L(){d("togglePrefs")}_t();var x=mr(),g=i(x),B=f(i(g),2);gr(B,{get models(){return l()},get modelsLoading(){return s()},get modelsError(){return w()},get onModelChange(){return p()},get model(){return r()},set model(D){r(D)},$$legacy:!0}),o(g);var H=f(g,2);o(x),O("click",H,L),b(n,x),yt()}var xr=T('<div class="text-sm text-red-400"> </div>'),hr=T('<div class="flex flex-col gap-4 flex-1 overflow-y-auto md:max-h-80 md:min-h-60 md:pr-1"><label class="flex flex-col gap-1" for="prefBaseUrl"><span class="text-sm text-zinc-300">LM Studio Base URL</span> <input id="prefBaseUrl" type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="http://localhost:1234"/></label> <label class="flex flex-col gap-1" for="prefApiKey"><span class="text-sm text-zinc-300">API Key (optional)</span> <input id="prefApiKey" type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="Bearer token"/></label> <label class="flex flex-col gap-1" for="prefTemp"><span class="text-sm text-zinc-300">Temperature</span> <input id="prefTemp" type="number" step="0.1" min="0" max="2" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40"/></label> <!></div>'),_r=T('<span class="text-xs text-emerald-400 uppercase">Romanization</span>'),wr=T('<button type="button" class="p-2 rounded-md text-red-400 hover:bg-red-500/10 transition-colors cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"></path><path d="M10 11v6"></path><path d="M14 11v6"></path><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"></path></svg></button>'),yr=T('<div class="flex items-center justify-between bg-zinc-900/60 rounded-lg px-3 py-2 transition-colors cursor-pointer hover:bg-zinc-800" role="button" tabindex="0"><div><div class="text-sm font-medium text-zinc-100"> </div> <div class="text-xs uppercase tracking-wide text-zinc-500"> </div></div> <div class="flex items-center gap-3"><!> <button type="button" class="p-2 rounded-md text-zinc-300 hover:bg-zinc-700/70 transition-colors cursor-pointer"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4Z"></path></svg></button> <!></div></div>'),zr=T('<div class="flex flex-col gap-4 flex-1 overflow-y-auto md:max-h-80 md:min-h-60 md:pr-1"><div class="flex items-center justify-between"><div><h3 class="text-sm font-medium text-zinc-100">Manage Languages</h3> <p class="text-xs text-zinc-400">Edit, add or remove languages.</p></div> <button type="button" class="flex items-center gap-2 px-2 py-1 rounded bg-zinc-800 hover:bg-zinc-700 text-sm cursor-pointer" aria-label="Add languages"><span class="text-lg leading-none">+</span> <span>Add</span></button></div> <div class="flex flex-col gap-2"></div></div>'),kr=T('<div class="text-sm text-red-400"> </div>'),Lr=T('<div class="border border-zinc-800 bg-zinc-900/70 rounded-lg p-4 flex flex-col gap-3"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Name</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="e.g. Klingon" autocomplete="off"/></label> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Code</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="e.g. tlh" autocomplete="off"/></label></div> <div class="flex items-center justify-between bg-zinc-900 px-3 py-2 rounded-lg border border-zinc-800"><div><div class="text-sm font-medium text-zinc-100">Romanization</div> <div class="text-xs text-zinc-500">Toggle if transliteration output is desired.</div></div> <button type="button"> </button></div> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Custom Prompt (optional)</span> <textarea rows="3" class="w-full p-3 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 resize-none" placeholder="Add any instructions for this language"></textarea></label> <!> <div class="flex justify-end gap-2"><button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Cancel</button> <button type="button" class="px-3 py-1 rounded bg-blue-600 hover:bg-blue-500 text-white cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"> </button></div></div>'),Er=T('<div class="text-sm text-red-400"> </div>'),Tr=T('<div class="text-sm text-zinc-400">Loading…</div>'),Cr=T('<div class="flex items-center justify-between bg-zinc-900/60 rounded-lg px-3 py-2"><div><div class="text-sm font-medium text-zinc-100"> </div> <div class="text-xs uppercase tracking-wide text-zinc-500"> </div></div> <button type="button" class="p-2 rounded-md text-emerald-400 hover:bg-zinc-800/70 transition-colors cursor-pointer"><svg viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"></path><path d="M5 12h14"></path></svg></button></div>'),Sr=T('<div class="flex flex-col gap-2"></div>'),Ar=T('<div class="text-sm text-zinc-400">All available languages are already added.</div>'),Mr=T('<div class="flex flex-col gap-4 flex-1 overflow-y-auto md:max-h-80 md:min-h-60 md:pr-1"><div class="flex items-center justify-between gap-3"><div><h3 class="text-sm font-medium text-zinc-100">Add Languages</h3> <p class="text-xs text-zinc-400">Choose additional languages from the library or create your own.</p></div> <div class="flex items-center gap-2"><button type="button" class="px-2 py-1 rounded bg-zinc-800 hover:bg-zinc-700 text-sm cursor-pointer">Add Custom</button></div></div> <!> <!> <!></div>'),Nr=T('<div class="text-sm text-red-400"> </div>'),Or=T('<div class="flex flex-col gap-5"><div class="space-y-4"><label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Name</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 disabled:opacity-60 disabled:cursor-not-allowed"/></label> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Code</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 disabled:opacity-60 disabled:cursor-not-allowed"/></label> <div class="flex items-center justify-between bg-zinc-900/60 px-3 py-2 rounded-lg"><div><div class="text-sm font-medium text-zinc-100">Romanization</div> <div class="text-xs text-zinc-500">Enable if you want transliteration output.</div></div> <button type="button"> </button></div> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Custom Prompt</span> <textarea rows="4" class="w-full p-3 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 resize-none"></textarea></label> <!></div></div>'),Ir=T('<p class="text-sm text-zinc-400">Select a language to edit.</p>'),jr=T('<button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600 cursor-pointer">Cancel</button> <button type="button" class="px-3 py-1 rounded border border-blue-500 text-blue-400 hover:bg-blue-500/10 disabled:opacity-50 disabled:cursor-not-allowed"> </button>',1),Dr=T('<button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600">Close</button>'),Rr=T('<button type="button" class="px-3 py-1 border border-zinc-700 rounded text-zinc-200 hover:bg-zinc-800/60 cursor-pointer">Back to list</button> <button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600">Close</button>',1),Br=T('<button type="button" class="px-3 py-1 border border-zinc-700 rounded text-zinc-200 hover:bg-zinc-800/60 cursor-pointer">Back</button> <button type="button" class="flex items-center gap-2 px-2 py-1 rounded bg-zinc-800 hover:bg-zinc-700 text-sm cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"> </button>',1),Pr=T('<div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-start md:items-center justify-center" role="button" tabindex="0" aria-label="Close preferences"><div class="bg-zinc-900 text-zinc-100 w-full h-full md:h-auto md:max-w-3xl md:rounded-xl shadow-xl md:p-6 p-4 overflow-hidden flex flex-col" role="dialog" aria-modal="true" tabindex="0"><h2 class="text-xl font-semibold mb-4 md:mb-6">Preferences</h2> <div class="mt-3 flex flex-col md:flex-row gap-6 overflow-y-auto flex-1"><nav class="flex md:flex-col gap-2 md:w-48 md:sticky md:top-0 bg-zinc-900 md:bg-transparent pb-4 md:pb-0"><button type="button">Connections</button> <button type="button">Languages</button></nav> <section class="flex-1 min-h-[18rem] pb-20 md:pb-0"><!></section></div> <div class="mt-4 md:mt-6 flex justify-end gap-2"><!></div></div></div>');function Fr(n,a){wt(a,!1);let r=pe(a,"baseUrl",12,""),l=pe(a,"apiKey",12,""),s=pe(a,"temperature",12,.2),w=pe(a,"languages",24,()=>[]);const p=Vt();let d=_("connections"),L=_(null),x=_(""),g=_({name:"",code:"",romanize:!1,prompt:""}),B=_(""),H=_(!1),D=_([]),y=_(!1),u=_(""),E=_(!1),S=_(""),k=_(""),U=_(!1),W=_(""),j=_(""),v=_(!1),M=_(""),F=_(!1);function X(){p("close")}async function Ae(){t(M,"");const c=r().trim(),z=typeof s()=="number"?s():Number(s());if(!c){t(M,"Base URL is required.");return}if(!Number.isFinite(z)){t(M,"Temperature must be a number.");return}r(c),s(z),t(F,!0);try{const N=await fetch("/api/connections",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({base_url:c,api_key:l(),temperature:z})});if(!N.ok){const C=await N.json().catch(()=>({}));throw new Error(C.error||N.statusText)}p("save")}catch(N){t(M,N instanceof Error?N.message:"Failed to save connections.")}finally{t(F,!1)}}function ae(c){c.target===c.currentTarget&&X()}function J(c){if(c.key==="Escape"){X();return}c.target===c.currentTarget&&(c.key==="Enter"||c.key===" ")&&X()}function P(c){c.key==="Escape"&&X()}function le(){t(S,""),t(k,""),t(U,!1),t(W,""),t(j,""),t(v,!1)}function ge(c){t(d,c),c!=="language-edit"&&(t(L,null),t(B,"")),c!=="languages-add"&&(t(E,!1),le()),c==="languages-add"&&Me()}function be(c){t(L,c),t(x,c.code),t(g,{...c}),t(B,""),t(d,"language-edit")}function fe(){t(g,{...e(g),romanize:!e(g).romanize})}function re(){t(L,null),t(B,""),t(d,"languages")}async function Fe(){if(e(L)){t(B,""),t(H,!0);try{const c=await fetch(`/api/languages/${encodeURIComponent(e(x))}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e(g).name.trim(),code:e(g).code.trim(),romanize:e(g).romanize,prompt:e(g).prompt})});if(!c.ok){const z=await c.json().catch(()=>({}));throw new Error(z.error||c.statusText)}p("languagesUpdated"),re()}catch(c){t(B,c instanceof Error?c.message:"Failed to update language.")}finally{t(H,!1)}}}async function Me(){if(!e(y)){t(y,!0),t(u,"");try{const c=await fetch("/api/languages/addable"),z=await c.json();if(!c.ok)throw new Error(z.error||"Failed to load languages");t(D,z.languages||[])}catch(c){t(u,c instanceof Error?c.message:"Failed to load languages")}finally{t(y,!1)}}}function Ne(){ge("languages-add")}function ke(){le(),t(E,!0)}function Ue(){le(),t(E,!1)}function et(){t(U,!e(U))}function Ve(c){return c.replace(/[^A-Za-z0-9-]/g,"")}function st(c){const z=c.currentTarget,N=Ve(z.value);z.value!==N&&(z.value=N),t(S,N)}function tt(c){const z=c.currentTarget,N=Ve(z.value);z.value!==N&&(z.value=N),t(k,N)}async function lt(){const c=Ve(e(S)),z=Ve(e(k));c!==e(S)&&t(S,c),z!==e(k)&&t(k,z);const N=e(S).trim(),C=e(k).trim(),q=e(W);if(!N||!C){t(j,"Name and code are required.");return}t(j,""),t(v,!0);try{const V=await fetch("/api/languages/add-custom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:N,code:C,romanize:e(U),prompt:q})}),ee=await V.json().catch(()=>({}));if(!V.ok)throw new Error(ee.error||"Failed to add language.");p("languagesUpdated"),await Me(),le(),t(E,!1)}catch(V){t(j,V instanceof Error?V.message:"Failed to add language.")}finally{t(v,!1)}}async function h(c){try{const z=await fetch(`/api/languages/add/${encodeURIComponent(c)}`,{method:"POST"});if(!z.ok){const N=await z.json().catch(()=>({}));throw new Error(N.error||"Failed to add language")}p("languagesUpdated"),t(D,e(D).filter(N=>N.code!==c)),e(d)==="languages-add"&&Me()}catch(z){t(u,z instanceof Error?z.message:"Failed to add language")}}async function ie(c){if(c)try{const z=await fetch(`/api/languages/${encodeURIComponent(c)}`,{method:"DELETE"});if(!z.ok){const N=await z.json().catch(()=>({}));throw new Error(N.error||"Failed to remove language")}p("languagesUpdated"),e(d)==="languages-add"&&Me()}catch(z){t(B,z instanceof Error?z.message:"Failed to remove language")}}_t();var me=Pr();O("keydown",pa,P);var Le=i(me),xe=f(i(Le),2),Be=i(xe),Ge=i(Be),at=f(Ge,2);o(Be);var vt=f(Be,2),Oe=i(vt);{var rt=c=>{var z=hr(),N=i(z),C=f(i(N),2);ot(C),o(N);var q=f(N,2),V=f(i(q),2);ot(V),o(q);var ee=f(q,2),he=f(i(ee),2);ot(he),o(ee);var Te=f(ee,2);{var qe=ve=>{var I=xr(),$=i(I,!0);o(I),Q(()=>ne($,e(M))),b(ve,I)};R(Te,ve=>{e(M)&&ve(qe)})}o(z),We(C,r),We(V,l),We(he,s),b(c,z)},m=c=>{var z=$e(),N=ze(z);{var C=V=>{var ee=zr(),he=i(ee),Te=f(i(he),2);o(he);var qe=f(he,2);ut(qe,5,w,mt,(ve,I)=>{var $=yr(),_e=i($),we=i(_e),Ie=i(we,!0);o(we);var Ke=f(we,2),De=i(Ke,!0);o(Ke),o(_e);var Ee=f(_e,2),te=i(Ee);{var de=Z=>{var Ce=_r();b(Z,Ce)};R(te,Z=>{e(I),G(()=>e(I).romanize)&&Z(de)})}var ye=f(te,2),se=f(ye,2);{var ue=Z=>{var Ce=wr();Q(()=>it(Ce,"aria-label",(e(I),G(()=>`Remove ${e(I).name}`)))),O("click",Ce,ea(()=>ie(e(I).code))),b(Z,Ce)};R(se,Z=>{e(I),G(()=>e(I).code!=="auto")&&Z(ue)})}o(Ee),o($),Q(()=>{ne(Ie,(e(I),G(()=>e(I).name))),ne(De,(e(I),G(()=>e(I).code))),it(ye,"aria-label",(e(I),G(()=>`Edit ${e(I).name}`)))}),O("click",ye,()=>be(e(I))),O("click",$,()=>be(e(I))),O("keydown",$,Z=>(Z.key==="Enter"||Z.key===" ")&&be(e(I))),b(ve,$)}),o(qe),o(ee),O("click",Te,Ne),b(V,ee)},q=V=>{var ee=$e(),he=ze(ee);{var Te=ve=>{var I=Mr(),$=i(I),_e=f(i($),2),we=i(_e);o(_e),o($);var Ie=f($,2);{var Ke=se=>{var ue=Lr(),Z=i(ue),Ce=i(Z),He=f(i(Ce),2);ot(He),o(Ce);var Pe=f(Ce,2),Ze=f(i(Pe),2);ot(Ze),o(Pe),o(Z);var Ye=f(Z,2),Re=f(i(Ye),2),gt=i(Re,!0);o(Re),o(Ye);var ct=f(Ye,2),je=f(i(ct),2);Ft(je),o(ct);var ft=f(ct,2);{var bt=Qe=>{var Nt=kr(),_a=i(Nt,!0);o(Nt),Q(()=>ne(_a,e(j))),b(Qe,Nt)};R(ft,Qe=>{e(j)&&Qe(bt)})}var Et=f(ft,2),xt=i(Et),Tt=f(xt,2),ha=i(Tt,!0);o(Tt),o(Et),o(ue),Q(Qe=>{Je(Re,1,`px-3 py-1 rounded-full text-sm transition-colors ${e(U)?"bg-emerald-500 text-white":"bg-zinc-700 text-zinc-300"}`),ne(gt,e(U)?"On":"Off"),xt.disabled=e(v),Tt.disabled=Qe,ne(ha,e(v)?"Saving…":"Save Language")},[()=>(e(v),e(S),e(k),G(()=>e(v)||!e(S).trim()||!e(k).trim()))]),We(He,()=>e(S),Qe=>t(S,Qe)),O("input",He,st),We(Ze,()=>e(k),Qe=>t(k,Qe)),O("input",Ze,tt),O("click",Re,et),We(je,()=>e(W),Qe=>t(W,Qe)),O("click",xt,Ue),O("click",Tt,lt),b(se,ue)};R(Ie,se=>{e(E)&&se(Ke)})}var De=f(Ie,2);{var Ee=se=>{var ue=Er(),Z=i(ue,!0);o(ue),Q(()=>ne(Z,e(u))),b(se,ue)};R(De,se=>{e(u)&&se(Ee)})}var te=f(De,2);{var de=se=>{var ue=Tr();b(se,ue)},ye=se=>{var ue=$e(),Z=ze(ue);{var Ce=Pe=>{var Ze=Sr();ut(Ze,5,()=>e(D),Ye=>Ye.code,(Ye,Re)=>{var gt=Cr(),ct=i(gt),je=i(ct),ft=i(je,!0);o(je);var bt=f(je,2),Et=i(bt,!0);o(bt),o(ct);var xt=f(ct,2);o(gt),Q(()=>{ne(ft,(e(Re),G(()=>e(Re).name))),ne(Et,(e(Re),G(()=>e(Re).code))),it(xt,"aria-label",(e(Re),G(()=>`Add ${e(Re).name}`)))}),O("click",xt,()=>h(e(Re).code)),b(Ye,gt)}),o(Ze),b(Pe,Ze)},He=Pe=>{var Ze=Ar();b(Pe,Ze)};R(Z,Pe=>{e(D),G(()=>e(D).length)?Pe(Ce):Pe(He,!1)},!0)}b(se,ue)};R(te,se=>{e(y)?se(de):se(ye,!1)})}o(I),O("click",we,ke),b(ve,I)},qe=ve=>{var I=$e(),$=ze(I);{var _e=we=>{var Ie=$e(),Ke=ze(Ie);{var De=te=>{var de=Or(),ye=i(de),se=i(ye),ue=f(i(se),2);ot(ue),o(se);var Z=f(se,2),Ce=f(i(Z),2);ot(Ce),o(Z);var He=f(Z,2),Pe=f(i(He),2),Ze=i(Pe,!0);o(Pe),o(He);var Ye=f(He,2),Re=f(i(Ye),2);Ft(Re),o(Ye);var gt=f(Ye,2);{var ct=je=>{var ft=Nr(),bt=i(ft,!0);o(ft),Q(()=>ne(bt,e(B))),b(je,ft)};R(gt,je=>{e(B)&&je(ct)})}o(ye),o(de),Q(()=>{ue.disabled=e(x)==="auto",Ce.disabled=e(x)==="auto",Je(Pe,1,(e(g),G(()=>`px-3 py-1 rounded-full text-sm transition-colors ${e(g).romanize?"bg-emerald-500 text-white":"bg-zinc-700 text-zinc-300"}`))),ne(Ze,(e(g),G(()=>e(g).romanize?"On":"Off")))}),We(ue,()=>e(g).name,je=>Lt(g,e(g).name=je)),We(Ce,()=>e(g).code,je=>Lt(g,e(g).code=je)),O("click",Pe,fe),We(Re,()=>e(g).prompt,je=>Lt(g,e(g).prompt=je)),b(te,de)},Ee=te=>{var de=Ir();b(te,de)};R(Ke,te=>{e(L)?te(De):te(Ee,!1)})}b(we,Ie)};R($,we=>{e(d)==="language-edit"&&we(_e)},!0)}b(ve,I)};R(he,ve=>{e(d)==="languages-add"?ve(Te):ve(qe,!1)},!0)}b(V,ee)};R(N,V=>{e(d)==="languages"?V(C):V(q,!1)},!0)}b(c,z)};R(Oe,c=>{e(d)==="connections"?c(rt):c(m,!1)})}o(vt),o(xe);var A=f(xe,2),K=i(A);{var ce=c=>{var z=jr(),N=ze(z),C=f(N,2),q=i(C,!0);o(C),Q(()=>{C.disabled=e(F),ne(q,e(F)?"Saving…":"Save")}),O("click",N,X),O("click",C,Ae),b(c,z)},Y=c=>{var z=$e(),N=ze(z);{var C=V=>{var ee=Dr();O("click",ee,X),b(V,ee)},q=V=>{var ee=$e(),he=ze(ee);{var Te=ve=>{var I=Rr(),$=ze(I),_e=f($,2);O("click",$,()=>ge("languages")),O("click",_e,X),b(ve,I)},qe=ve=>{var I=$e(),$=ze(I);{var _e=we=>{var Ie=Br(),Ke=ze(Ie),De=f(Ke,2),Ee=i(De,!0);o(De),Q(()=>{De.disabled=e(H),ne(Ee,e(H)?"Saving…":"Save Changes")}),O("click",Ke,re),O("click",De,Fe),b(we,Ie)};R($,we=>{e(d)==="language-edit"&&we(_e)},!0)}b(ve,I)};R(he,ve=>{e(d)==="languages-add"?ve(Te):ve(qe,!1)},!0)}b(V,ee)};R(N,V=>{e(d)==="languages"?V(C):V(q,!1)},!0)}b(c,z)};R(K,c=>{e(d)==="connections"?c(ce):c(Y,!1)})}o(A),o(Le),o(me),Q(()=>{Je(Ge,1,Yt(e(d)==="connections"?"px-3 py-2 rounded-lg bg-zinc-800 text-white text-left":"px-3 py-2 rounded-lg text-zinc-400 hover:bg-zinc-800/60 text-left")),Je(at,1,Yt(e(d)==="languages"||e(d)==="languages-add"?"px-3 py-2 rounded-lg bg-zinc-800 text-white text-left":"px-3 py-2 rounded-lg text-zinc-400 hover:bg-zinc-800/60 text-left"))}),O("click",Ge,()=>ge("connections")),O("click",at,()=>ge("languages")),O("pointerdown",Le,ea(function(c){rr.call(this,a,c)})),O("click",me,ae),O("keydown",me,J),b(n,me),yt()}var Ur=T('<span class="text-xs uppercase tracking-wide text-zinc-400"> </span>'),Kr=T('<p class="p-4 text-sm text-zinc-400">No languages found.</p>'),Hr=ga('<svg class="w-4 h-4 text-zinc-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M16.704 5.29a1 1 0 010 1.42l-7.5 7.5a1 1 0 01-1.414 0l-3.5-3.5a1 1 0 011.414-1.42L8.5 11.086l6.793-6.794a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>'),Jr=T('<li><button type="button"><div><div class="font-medium"> </div> <div class="text-xs uppercase tracking-wide text-zinc-500"> </div></div> <!></button></li>'),Vr=T('<ul class="divide-y divide-zinc-900"></ul>'),qr=T('<div class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex flex-col" role="dialog" aria-modal="true"><div class="mt-8 p-4 bg-zinc-900 border-b border-zinc-800 space-y-3"><h2 class="text-sm font-medium text-zinc-100"> </h2> <div class="flex items-center gap-2"><input type="text" class="flex-1 px-3 py-2 rounded bg-zinc-800 border border-zinc-700 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-zinc-500/40" placeholder="Search languages"/> <button type="button" class="px-3 py-2 rounded bg-zinc-800 hover:bg-zinc-700 text-sm text-zinc-200">Close</button></div></div> <div class="flex-1 overflow-auto bg-zinc-950"><!></div></div>'),Wr=T('<div class="flex flex-col gap-1"><!> <button type="button" class="flex items-center justify-between w-full px-3 py-2 rounded-lg bg-zinc-800 text-left text-sm text-zinc-100 border border-zinc-700 hover:bg-zinc-700/80 transition-colors"><span class="truncate"> </span> <svg class="w-4 h-4 text-zinc-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button></div> <!>',1);function aa(n,a){wt(a,!1);let r=pe(a,"label",8,""),l=pe(a,"languages",24,()=>[]),s=pe(a,"selectedCode",8,null);const w=Vt();let p=_(!1),d=_(""),L=_(),x=_([]);function g(v){w("select",v),t(p,!1),t(d,"")}function B(){t(p,!0)}function H(){t(p,!1),t(d,"")}Se(()=>(oe(l()),oe(s())),()=>{t(L,l().find(v=>v.code===s()))}),Se(()=>(e(d),oe(l())),()=>{t(x,e(d)?l().filter(v=>{const M=e(d).toLowerCase();return v.name.toLowerCase().includes(M)||v.code.toLowerCase().includes(M)}):l())}),Mt(),_t();var D=Wr(),y=ze(D),u=i(y);{var E=v=>{var M=Ur(),F=i(M,!0);o(M),Q(()=>ne(F,r())),b(v,M)};R(u,v=>{r()&&v(E)})}var S=f(u,2),k=i(S),U=i(k,!0);o(k),qt(2),o(S),o(y);var W=f(y,2);{var j=v=>{var M=qr(),F=i(M),X=i(F),Ae=i(X,!0);o(X);var ae=f(X,2),J=i(ae);ot(J);var P=f(J,2);o(ae),o(F);var le=f(F,2),ge=i(le);{var be=re=>{var Fe=Kr();b(re,Fe)},fe=re=>{var Fe=Vr();ut(Fe,5,()=>e(x),Me=>Me.code,(Me,Ne)=>{var ke=Jr(),Ue=i(ke),et=i(Ue),Ve=i(et),st=i(Ve,!0);o(Ve);var tt=f(Ve,2),lt=i(tt,!0);o(tt),o(et);var h=f(et,2);{var ie=me=>{var Le=Hr();b(me,Le)};R(h,me=>{e(Ne),oe(s()),G(()=>e(Ne).code===s())&&me(ie)})}o(Ue),o(ke),Q(()=>{Je(Ue,1,(e(Ne),oe(s()),G(()=>`w-full px-4 py-3 text-left text-sm flex items-center justify-between ${e(Ne).code===s()?"bg-zinc-600/20 text-zinc-100":"text-zinc-200 hover:bg-zinc-900"}`))),ne(st,(e(Ne),G(()=>e(Ne).name))),ne(lt,(e(Ne),G(()=>e(Ne).code)))}),O("click",Ue,()=>g(e(Ne).code)),b(Me,ke)}),o(Fe),b(re,Fe)};R(ge,re=>{e(x),G(()=>e(x).length===0)?re(be):re(fe,!1)})}o(le),o(M),Q(()=>ne(Ae,r()||"Select Language")),We(J,()=>e(d),re=>t(d,re)),O("click",P,H),b(v,M)};R(W,v=>{e(p)&&v(j)})}Q(()=>ne(U,(e(L),G(()=>e(L)?`${e(L).name}`:"Select language")))),O("click",S,B),b(n,D),yt()}var $r=T('<div class="flex items-center gap-2 w-full"><div class="flex-1 min-w-0"><!></div> <button type="button"> </button> <div class="flex-1 min-w-0"><!></div></div>'),Gr=T('<button type="button"> </button>'),Zr=T('<button type="button" class="w-full text-left px-3 py-2 text-sm text-zinc-200 bg-transparent cursor-pointer rounded-md transition-colors duration-150 hover:bg-zinc-700/70 hover:text-white"> </button>'),Yr=T('<div class="absolute left-0 mt-2 min-w-[200px] bg-zinc-900 rounded shadow-lg z-40 max-h-60 overflow-auto p-2" role="listbox"></div>'),Qr=T('<!> <div class="relative"><button type="button" class="px-3 py-1 rounded-md text-sm text-zinc-300 flex items-center gap-1 bg-transparent transition-colors hover:bg-zinc-800/70 hover:text-white" aria-haspopup="listbox"><span>More</span> <svg class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button> <!></div>',1),Xr=T('<button type="button" class="absolute top-2 right-2 h-6 w-6 rounded-full bg-zinc-700/70 text-zinc-200 flex items-center justify-center text-xs hover:bg-zinc-600 transition-colors" aria-label="Clear input">✕</button>'),en=T('<div class="absolute inset-0 px-3 py-2 text-zinc-500 pointer-events-none flex gap-2"><span>Type</span> <img src="/images/slash.svg" alt="Slash key" class="mt-1 h-4 w-4"/> <span>to input</span></div>'),tn=T('<button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600 text-sm" title="Switch languages">⇄</button>'),an=T('<button type="button"> </button>'),rn=T('<button type="button" class="w-full text-left px-3 py-2 text-sm text-zinc-200 bg-transparent cursor-pointer rounded-md transition-colors duration-150 hover:bg-zinc-700/70 hover:text-white"> </button>'),nn=T('<div class="absolute left-0 mt-2 min-w-[200px] bg-zinc-900 rounded shadow-lg z-40 max-h-60 overflow-auto p-2" role="listbox"></div>'),on=T('<!> <div class="relative"><button type="button" class="px-3 py-1 rounded-md text-sm text-zinc-300 flex items-center gap-1 bg-transparent transition-colors hover:bg-zinc-800/70 hover:text-white" aria-haspopup="listbox"><span>More</span> <svg class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button> <!></div>',1),sn=T('<div class="text-zinc-400 italic whitespace-pre-wrap"> </div>'),ln=T('<button type="button" class="flex items-center gap-2 rounded-md py-1 text-sm text-zinc-300 transition-colors hover:text-zinc-100"><span> </span> <svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 1 1 1.06 1.06l-4.24 4.24a.75.75 0 0 1-1.06 0L5.21 8.29a.75.75 0 0 1 .02-1.08Z" clip-rule="evenodd"></path></svg></button>'),cn=T('<pre class="whitespace-pre-wrap rounded-md bg-zinc-900/70 px-3 py-2 text-xs leading-relaxed text-zinc-400"> </pre>'),dn=T('<div class="mt-auto space-y-2"><div class="flex items-center gap-2"><!> <button type="button" class="ml-auto p-2 rounded-md text-zinc-300 bg-transparent transition-colors hover:bg-zinc-700/70" aria-label="Copy translation"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div> <!></div>'),un=T('<div class="absolute bottom-3 right-3"><svg class="h-5 w-5 animate-spin text-zinc-400" viewBox="0 0 24 24" fill="none"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v3a5 5 0 00-5 5H4z"></path></svg></div>'),vn=T('<div class="flex flex-col gap-2 h-full"><div class="flex gap-2 flex-wrap items-center relative w-full"><!> <!></div> <div class="relative flex-1 rounded-xl bg-zinc-800 h-full p-3 flex flex-col gap-3 min-h-[14rem]"><div> </div> <!> <!> <!></div></div>'),fn=T('<div class="grid grid-cols-1 lg:grid-cols-2 min-h-[200px] gap-6 relative z-0"><div class="flex flex-col gap-2"><div class="flex gap-2 flex-wrap relative w-full"><!></div> <div class="relative flex-1 w-full min-h-[14rem]"><textarea class="flex-1 rounded-xl bg-zinc-800 p-3 pr-10 h-full resize-none focus:outline-none w-full min-h-[14rem]" aria-label="Input text"></textarea> <!> <!></div></div> <!></div>');function pn(n,a){wt(a,!1);let r=pe(a,"model",8,""),l=pe(a,"temperature",8,.2),s=pe(a,"languages",24,()=>[]),w=pe(a,"defaultSource",8,"auto"),p=pe(a,"defaultTarget",8,"zh-CN"),d=_(""),L=_(""),x=_(""),g=_(!1),B=_(!0),H=_(null),D=_(null),y=_(null),u=_(w()),E=_(p()),S=_([w(),"en",p()]),k=_(["en",p(),"ja"]),U=_(!1),W=_(!1),j=_(!1),v=_(!1),M=_(""),F=null,X=_(),Ae=_(!0),ae=_(""),J=_(!1),P=_(0);function le(){const m=localStorage.getItem("recentSources"),A=localStorage.getItem("recentTargets");if(m)try{const K=JSON.parse(m);Array.isArray(K)&&K.length&&t(S,K)}catch{}if(A)try{const K=JSON.parse(A);Array.isArray(K)&&K.length&&t(k,K)}catch{}e(S).includes("auto")?t(S,["auto",...e(S).filter(K=>K!=="auto")]):t(S,["auto",...e(S)]),t(k,e(k).filter(K=>K!=="auto"))}function ge(){if(!s()||s().length===0)return;const m=s().filter(C=>C.code!=="auto");if(!m.length)return;const A=m.map(C=>C.code),ce=e(k).find(C=>A.includes(C))??A[0];if(!ce)return;(!A.includes(e(E))||e(E)!==ce)&&t(E,ce);const Y=e(k).filter(C=>C!==ce&&A.includes(C)),c=[ce,...Y];if(c.length<3){for(const C of A)if(c.includes(C)||c.push(C),c.length>=3)break}const z=c.slice(0,3);(z.length!==e(k).length||z.some((C,q)=>C!==e(k)[q]))&&(t(k,z),be())}function be(){localStorage.setItem("recentSources",JSON.stringify(e(S))),localStorage.setItem("recentTargets",JSON.stringify(e(k)))}function fe(m,A,K=3){if(m==="recentSources"){if(A==="auto"){t(u,"auto");return}t(u,A);const ce=e(S).filter(Y=>Y!=="auto"&&Y!==A);t(S,["auto",A,...ce].slice(0,K)),be()}else{if(A==="auto")return;t(E,A),t(k,[A,...e(k).filter(ce=>ce!==A)].slice(0,K)),be()}}function re(m){fe("recentSources",m),t(U,!1),ke()}function Fe(m){fe("recentTargets",m),t(W,!1),ke()}function Me(){if(e(u)==="auto")return;const m=e(u);t(u,e(E)),t(E,m),fe("recentSources",e(u)),fe("recentTargets",e(E)),ke()}function Ne(){F&&clearTimeout(F),t(L,""),t(x,""),t(ae,""),t(J,!1),t(P,0),F=setTimeout(()=>ke(),700)}async function ke(){if(!e(d).trim()){t(L,""),t(x,""),t(g,!1),t(ae,""),t(J,!1),t(P,0);return}if(!r()){t(L,"Select a model to translate."),t(x,""),t(g,!1),t(ae,""),t(J,!1),t(P,0);return}const m=Date.now();t(g,!0),t(L,"Translating…"),t(x,""),t(ae,""),t(J,!1),t(P,0);try{const A=s().find(q=>q.code===e(E)),K=A?.romanize?A.prompt||"Also include a 'romanization' string that reflects the pronunciation of the translated output text (never the source text).":"Do not include romanization.";let c=(await(await fetch("/api/proxy/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:r(),temperature:l(),messages:[{role:"system",content:`
You are a professional translator. Preserve tone, punctuation, spacing, and line breaks.
Return ONLY strict JSON (no code fences, no extra text) in this exact shape:
{"output": "translated text", "romanization": "if applicable, otherwise empty string"}.
${K}
`},{role:"user",content:`Translate the following text from ${e(u)} to ${e(E)}.
Text: ${e(d)}`}]})})).json())?.choices?.[0]?.message?.content??"",z="";const N=c.match(/<think>([\s\S]*?)<\/think>/i);N&&(z=N[1].trim(),c=c.replace(N[0],"").trim());let C;try{C=JSON.parse(c)}catch{const q=c.indexOf("{"),V=c.lastIndexOf("}");if(q!==-1&&V!==-1&&V>q)try{C=JSON.parse(c.slice(q,V+1))}catch{C={output:c,romanization:""}}else C={output:c,romanization:""}}if(t(L,C.output||C.translation||""),t(x,A?.romanize&&C.romanization||""),z){t(ae,z);const q=Date.now()-m;t(P,Math.max(.1,Math.round(q/1e3*10)/10)),t(J,!1)}e(L)||t(L,"⚠️ Translation error (empty output)")}catch(A){console.error(A),t(L,"⚠️ Translation error"),t(x,""),t(ae,""),t(J,!1),t(P,0)}finally{t(g,!1)}}function Ue(m){if(m.key==="Escape"){t(U,!1),t(W,!1);return}if(m.key==="/"&&!m.defaultPrevented&&!m.ctrlKey&&!m.metaKey&&!m.altKey){const A=m.target,K=A instanceof HTMLElement?A.tagName.toLowerCase():"";if(K==="input"||K==="textarea")return;m.preventDefault(),e(H)&&(e(H).focus(),t(B,!1))}}function et(m){const A=m.target;e(U)&&e(D)&&!(A instanceof Node&&e(D).contains(A))&&t(U,!1),e(W)&&e(y)&&!(A instanceof Node&&e(y).contains(A))&&t(W,!1)}function Ve(m){return!m||Number.isNaN(m)?"0":m>=10?Math.round(m).toString():m.toFixed(1)}Ht(()=>{t(v,/mobile|android|iphone|ipad|ipod/i.test(navigator.userAgent||"")),t(M,e(v)?"Enter text":""),e(v)&&(t(U,!1),t(W,!1)),le(),ge(),s().length&&t(j,!0),window.addEventListener("keydown",Ue),window.addEventListener("click",et)}),Jt(()=>{F&&(clearTimeout(F),F=null),window.removeEventListener("keydown",Ue),window.removeEventListener("click",et)}),Se(()=>oe(r()),()=>{t(X,r())}),Se(()=>(e(X),oe(r()),e(d)),()=>{e(X)!==void 0&&r()!==e(X)&&e(d).trim()&&r()&&ke()}),Se(()=>(e(j),oe(s())),()=>{!e(j)&&s().length&&(ge(),t(j,!0))}),Se(()=>(e(j),oe(s()),e(E)),()=>{e(j)&&s().length&&!s().some(m=>m.code===e(E)&&m.code!=="auto")&&ge()}),Se(()=>(e(v),e(d)),()=>{t(Ae,!e(v)||!!e(d))}),Mt(),_t();var st=fn(),tt=i(st),lt=i(tt),h=i(lt);{var ie=m=>{var A=$r(),K=i(A),ce=i(K);aa(ce,{get languages(){return s()},get selectedCode(){return e(u)},$$events:{select:C=>re(C.detail)}}),o(K);var Y=f(K,2),c=i(Y,!0);o(Y);var z=f(Y,2),N=i(z);{let C=na(()=>(oe(s()),G(()=>s().filter(q=>q.code!=="auto"))));aa(N,{get languages(){return e(C)},get selectedCode(){return e(E)},$$events:{select:q=>Fe(q.detail)}})}o(z),o(A),Q(()=>{Je(Y,1,`shrink-0 px-3 py-2 rounded-full text-lg transition-colors ${e(u)==="auto"?"text-zinc-500 cursor-default":"text-zinc-200 hover:text-white"}`),it(Y,"title",e(u)==="auto"?"Switch disabled for Auto":"Switch languages"),Y.disabled=e(u)==="auto",ne(c,e(u)==="auto"?"→":"⇄")}),O("click",Y,()=>e(u)!=="auto"&&Me()),b(m,A)},me=m=>{var A=Qr(),K=ze(A);ut(K,1,()=>e(S),mt,(N,C)=>{var q=$e(),V=ze(q);{var ee=he=>{var Te=Gr(),qe=i(Te,!0);o(Te),Q(ve=>{Je(Te,1,`px-3 py-1 rounded text-sm transition-colors ${e(u)===e(C)?"bg-zinc-800/80 text-white":"bg-transparent text-zinc-300 hover:bg-zinc-800/70 hover:text-white"}`),ne(qe,ve)},[()=>(oe(s()),e(C),G(()=>s().find(ve=>ve.code===e(C))?.name))]),O("click",Te,()=>re(e(C))),b(he,Te)};R(V,he=>{oe(s()),e(C),G(()=>s().find(Te=>Te.code===e(C)))&&he(ee)})}b(N,q)});var ce=f(K,2),Y=i(ce),c=f(Y,2);{var z=N=>{var C=Yr();ut(C,5,()=>(oe(s()),e(S),G(()=>s().filter(q=>!e(S).includes(q.code)))),mt,(q,V)=>{var ee=Zr(),he=i(ee,!0);o(ee),Q(()=>ne(he,(e(V),G(()=>e(V).name)))),O("click",ee,()=>re(e(V).code)),b(q,ee)}),o(C),b(N,C)};R(c,N=>{e(U)&&N(z)})}o(ce),pt(ce,N=>t(D,N),()=>e(D)),Q(()=>it(Y,"aria-expanded",e(U))),O("click",Y,()=>t(U,!e(U))),b(m,A)};R(h,m=>{e(v)?m(ie):m(me,!1)})}o(lt);var Le=f(lt,2),xe=i(Le);Ft(xe),pt(xe,m=>t(H,m),()=>e(H));var Be=f(xe,2);{var Ge=m=>{var A=Xr();O("click",A,()=>{t(d,""),t(L,""),t(x,""),t(B,!0),t(ae,""),t(J,!1),t(P,0),e(H)?.focus()}),b(m,A)};R(Be,m=>{e(d)&&m(Ge)})}var at=f(Be,2);{var vt=m=>{var A=en();b(m,A)};R(at,m=>{!e(v)&&e(B)&&!e(d)&&m(vt)})}o(Le),o(tt);var Oe=f(tt,2);{var rt=m=>{var A=vn(),K=i(A),ce=i(K);{var Y=I=>{var $=tn();O("click",$,Me),b(I,$)};R(ce,I=>{e(v)||I(Y)})}var c=f(ce,2);{var z=I=>{var $=on(),_e=ze($);ut(_e,1,()=>e(k),mt,(Ee,te)=>{var de=$e(),ye=ze(de);{var se=ue=>{var Z=an(),Ce=i(Z,!0);o(Z),Q(He=>{Je(Z,1,`px-3 py-1 rounded text-sm transition-colors ${e(E)===e(te)?"bg-zinc-800/80 text-white":"bg-transparent text-zinc-300 hover:bg-zinc-800/70 hover:text-white"}`),ne(Ce,He)},[()=>(oe(s()),e(te),G(()=>s().find(He=>He.code===e(te))?.name??e(te)))]),O("click",Z,()=>Fe(e(te))),b(ue,Z)};R(ye,ue=>{oe(s()),e(te),G(()=>s().find(Z=>Z.code===e(te)&&Z.code!=="auto"))&&ue(se)})}b(Ee,de)});var we=f(_e,2),Ie=i(we),Ke=f(Ie,2);{var De=Ee=>{var te=nn();ut(te,5,()=>(oe(s()),e(k),G(()=>s().filter(de=>!e(k).includes(de.code)&&de.code!=="auto"))),mt,(de,ye)=>{var se=rn(),ue=i(se,!0);o(se),Q(()=>ne(ue,(e(ye),G(()=>e(ye).name)))),O("click",se,()=>Fe(e(ye).code)),b(de,se)}),o(te),b(Ee,te)};R(Ke,Ee=>{e(W)&&Ee(De)})}o(we),pt(we,Ee=>t(y,Ee),()=>e(y)),Q(()=>it(Ie,"aria-expanded",e(W))),O("click",Ie,()=>t(W,!e(W))),b(I,$)};R(c,I=>{e(v)||I(z)})}o(K);var N=f(K,2),C=i(N),q=i(C,!0);o(C);var V=f(C,2);{var ee=I=>{var $=sn(),_e=i($,!0);o($),Q(()=>ne(_e,e(x))),b(I,$)};R(V,I=>{e(x)&&I(ee)})}var he=f(V,2);{var Te=I=>{var $=dn(),_e=i($),we=i(_e);{var Ie=te=>{var de=ln(),ye=i(de),se=i(ye,!0);o(ye);var ue=f(ye,2);o(de),Q(Z=>{it(de,"aria-expanded",e(J)),ne(se,Z),Je(ue,0,`h-4 w-4 transition-transform ${e(J)?"rotate-180":""}`)},[()=>(e(J),e(P),G(()=>e(J)?"Hide thinking":`Thought for ${Ve(e(P))} seconds`))]),O("click",de,()=>t(J,!e(J))),b(te,de)};R(we,te=>{e(ae)&&te(Ie)})}var Ke=f(we,2);o(_e);var De=f(_e,2);{var Ee=te=>{var de=cn(),ye=i(de,!0);o(de),Q(()=>ne(ye,e(ae))),b(te,de)};R(De,te=>{e(ae)&&e(J)&&te(Ee)})}o($),O("click",Ke,()=>navigator.clipboard.writeText(e(L)||"")),b(I,$)};R(he,I=>{!e(g)&&e(L)&&I(Te)})}var qe=f(he,2);{var ve=I=>{var $=un();b(I,$)};R(qe,I=>{e(g)&&I(ve)})}o(N),o(A),Q(()=>{Je(C,1,`flex-1 whitespace-pre-wrap ${e(g)?"text-zinc-400 italic":"text-zinc-100"}`),ne(q,e(L))}),b(m,A)};R(Oe,m=>{e(Ae)&&m(rt)})}o(st),Q(()=>it(xe,"placeholder",e(M))),We(xe,()=>e(d),m=>t(d,m)),O("input",xe,Ne),O("focus",xe,()=>t(B,!1)),O("blur",xe,()=>t(B,!e(d))),b(n,st),yt()}var gn=T('<img src="/images/openlang.svg" alt="OpenLang" class="w-32 h-32"/>'),mn=T('<div class="fixed inset-0 z-[1002] flex items-center justify-center bg-black"><!></div>');function bn(n,a){let r=pe(a,"visible",8,!1);var l=$e(),s=ze(l);{var w=p=>{var d=mn(),L=i(d);Za(L,a,"default",{},x=>{var g=gn();b(x,g)}),o(d),b(p,d)};R(s,p=>{r()&&p(w)})}b(n,l)}var xn=T('<link rel="icon" href="/favicon.ico" sizes="any"/> <link rel="icon" type="image/svg+xml" href="/images/openlang.svg"/> <link rel="apple-touch-icon" href="/apple-touch-icon.png"/>',1),hn=T('<div class="min-h-screen bg-zinc-900 text-zinc-100 flex flex-col"><!> <main class="flex-1 max-w-7xl mx-auto p-6 w-full"><!></main> <!></div> <!>',1);function Tn(n,a){wt(a,!1);let r=pe(a,"data",8),l=_(r().languages),s=_(r().defaultSource),w=_(r().defaultTarget),p=_(!1),d=_(r().connections.base_url),L=_(r().connections.api_key),x=_(""),g=_(r().connections.temperature??.2),B=_([]),H=_(!1),D=_(""),y=_(!0),u;async function E(){t(H,!0),t(D,"");try{const P=await fetch("/api/proxy/v1/models");if(!P.ok)throw new Error(`Model request failed: ${P.status}`);const le=await P.json(),be=S(le).map(re=>typeof re=="string"?re:re&&typeof re=="object"&&(re.id||re.name||re.model_id||re.slug||re.label)||null).filter(Boolean),fe=Array.from(new Set(be));if(t(B,fe),fe.length===0){t(x,""),t(D,"Please start LM Studio API server.");return}t(D,""),(!e(x)||!fe.includes(e(x)))&&t(x,fe[0])}catch(P){console.error("Failed to load models:",P),t(B,[]),t(x,""),t(D,"Please start LM Studio API server.")}finally{t(H,!1)}}function S(P,le=0){if(!P||le>5)return[];if(Array.isArray(P))return P;if(P&&typeof P=="object"){const ge=P;for(const be of["data","models","items","list","result"]){const fe=ge[be];if(Array.isArray(fe))return fe}for(const be of Object.values(ge)){const fe=S(be,le+1);if(fe.length)return fe}}return[]}function k(P){P.key==="Escape"&&e(p)&&t(p,!1)}Ht(()=>{window.addEventListener("keydown",k),E(),u=window.setTimeout(()=>{t(y,!1)},200)}),Jt(()=>{window.removeEventListener("keydown",k),u&&clearTimeout(u)});async function U(){t(p,!1),await Zt(),E()}async function W(){await Zt()}Se(()=>oe(r()),()=>{t(l,r().languages)}),Se(()=>oe(r()),()=>{t(s,r().defaultSource)}),Se(()=>oe(r()),()=>{t(w,r().defaultTarget)}),Se(()=>oe(r()),()=>{t(d,r().connections.base_url)}),Se(()=>oe(r()),()=>{t(L,r().connections.api_key)}),Se(()=>oe(r()),()=>{t(g,r().connections.temperature??.2)}),Mt(),_t();var j=hn();qa(P=>{var le=xn();qt(4),b(P,le)});var v=ze(j),M=i(v);br(M,{get models(){return e(B)},get modelsLoading(){return e(H)},get modelsError(){return e(D)},get model(){return e(x)},set model(P){t(x,P)},$$events:{togglePrefs:()=>t(p,!e(p))},$$legacy:!0});var F=f(M,2),X=i(F);pn(X,{get model(){return e(x)},get temperature(){return e(g)},get languages(){return e(l)},get defaultSource(){return e(s)},get defaultTarget(){return e(w)}}),o(F);var Ae=f(F,2);{var ae=P=>{Fr(P,{get languages(){return e(l)},get baseUrl(){return e(d)},set baseUrl(le){t(d,le)},get apiKey(){return e(L)},set apiKey(le){t(L,le)},get temperature(){return e(g)},set temperature(le){t(g,le)},$$events:{close:()=>t(p,!1),save:U,languagesUpdated:W},$$legacy:!0})};R(Ae,P=>{e(p)&&P(ae)})}o(v);var J=f(v,2);bn(J,{get visible(){return e(y)}}),b(n,j),yt()}export{Tn as component};
