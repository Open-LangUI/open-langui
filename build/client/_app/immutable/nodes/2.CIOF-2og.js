import"../chunks/DsnmJJEf.js";import{i as _t}from"../chunks/CZYVMSbA.js";import{a as wa,o as Ht,b as Jt,e as N,s as re,c as Vt}from"../chunks/DcF3xoQD.js";import{h as tt,D as ra,C as ya,i as e,a3 as na,F as za,H as ka,G as Wt,I as Ot,J as jt,S as zt,af as La,aJ as Ta,M as Pt,P as Ea,O as ht,aF as oa,ay as ia,K as sa,aW as _,ac as $t,ae as Gt,Q as la,R as Ca,a_ as St,a$ as It,an as ca,b0 as At,b1 as Sa,at as Aa,b2 as Ma,aE as Na,b3 as Oa,a1 as da,aA as ja,b4 as ua,W as va,b5 as Ia,E as Da,b6 as Ra,b7 as Ba,T as Pa,e as $,b8 as Fa,aw as fa,b9 as Ua,w as kt,ba as Ka,aV as Ha,V as Ja,bb as Va,x as wt,bc as Me,bd as Mt,t as E,o as _e,v as Y,p as m,y as yt,j as ne,a0 as t,be as pa,B as v,z as i,A as o,ao as qt,bf as Lt,m as Ye,bg as ga,bh as Ft,n as qa}from"../chunks/DJ8JGTRo.js";import{p as ue,i as P,b as pt}from"../chunks/F2tdbd6K.js";import{s as ot,r as nt,a as Wa}from"../chunks/DspkWKzF.js";import{i as Zt}from"../chunks/CKgdIqQA.js";function mt(n,a){return a}function $a(n,a,r){for(var s=n.items,u=[],k=a.length,l=0;l<k;l++)Ma(a[l].e,u,!0);var f=k>0&&u.length===0&&r!==null;if(f){var A=r.parentNode;Na(A),A.append(r),s.clear(),rt(n,a[0].prev,a[k-1].next)}Oa(u,()=>{for(var g=0;g<k;g++){var p=a[g];f||(s.delete(p.k),rt(n,p.prev,p.next)),ca(p.e,!f)}})}function ct(n,a,r,s,u,k=null){var l=n,f={flags:a,items:new Map,first:null},A=(a&ua)!==0;if(A){var g=n;l=tt?Ot(ja(g)):g.appendChild(sa())}tt&&ra();var p=null,I=!1,J=new Map,D=na(()=>{var C=r();return ia(C)?C:C==null?[]:oa(C)}),w,b;function O(){Ga(b,w,f,J,l,u,a,s,r),k!==null&&(w.length===0?p?la(p):p=Pt(()=>k(l)):p!==null&&Ca(p,()=>{p=null}))}ya(()=>{b??=da,w=e(D);var C=w.length;if(I&&C===0)return;I=C===0;let L=!1;if(tt){var F=za(l)===ka;F!==(C===0)&&(l=Wt(),Ot(l),jt(!1),L=!0)}if(tt){for(var V=null,j,d=0;d<C;d++){if(zt.nodeType===La&&zt.data===Ta){l=zt,L=!0,jt(!1);break}var T=w[d],R=s(T,d);j=Ut(zt,f,V,null,T,R,d,u,a,r),f.items.set(R,j),V=j}C>0&&Ot(Wt())}if(tt)C===0&&k&&(p=Pt(()=>k(l)));else if(Ea()){var oe=new Set,xe=ht;for(d=0;d<C;d+=1){T=w[d],R=s(T,d);var fe=f.items.get(R)??J.get(R);fe?(a&(At|St))!==0&&ma(fe,T,d,a):(j=Ut(null,f,null,null,T,R,d,u,a,r,!0),J.set(R,j)),oe.add(R)}for(const[de,K]of f.items)oe.has(de)||xe.skipped_effects.add(K.e);xe.add_callback(O)}else O();L&&jt(!0),e(D)}),tt&&(l=zt)}function Ga(n,a,r,s,u,k,l,f,A){var g=(l&Ia)!==0,p=(l&(At|St))!==0,I=a.length,J=r.items,D=r.first,w=D,b,O=null,C,L=[],F=[],V,j,d,T;if(g)for(T=0;T<I;T+=1)V=a[T],j=f(V,T),d=J.get(j),d!==void 0&&(d.a?.measure(),(C??=new Set).add(d));for(T=0;T<I;T+=1){if(V=a[T],j=f(V,T),d=J.get(j),d===void 0){var R=s.get(j);if(R!==void 0){s.delete(j),J.set(j,R);var oe=O?O.next:w;rt(r,O,R),rt(r,R,oe),Dt(R,oe,u),O=R}else{var xe=w?w.e.nodes_start:u;O=Ut(xe,r,O,O===null?r.first:O.next,V,j,T,k,l,A)}J.set(j,O),L=[],F=[],w=O.next;continue}if(p&&ma(d,V,T,l),(d.e.f&It)!==0&&(la(d.e),g&&(d.a?.unfix(),(C??=new Set).delete(d))),d!==w){if(b!==void 0&&b.has(d)){if(L.length<F.length){var fe=F[0],de;O=fe.prev;var K=L[0],H=L[L.length-1];for(de=0;de<L.length;de+=1)Dt(L[de],fe,u);for(de=0;de<F.length;de+=1)b.delete(F[de]);rt(r,K.prev,H.next),rt(r,O,K),rt(r,H,fe),w=fe,O=H,T-=1,L=[],F=[]}else b.delete(d),Dt(d,w,u),rt(r,d.prev,d.next),rt(r,d,O===null?r.first:O.next),rt(r,O,d),O=d;continue}for(L=[],F=[];w!==null&&w.k!==j;)(w.e.f&It)===0&&(b??=new Set).add(w),F.push(w),w=w.next;if(w===null)continue;d=w}L.push(d),O=d,w=d.next}if(w!==null||b!==void 0){for(var ie=b===void 0?[]:oa(b);w!==null;)(w.e.f&It)===0&&ie.push(w),w=w.next;var we=ie.length;if(we>0){var ge=(l&ua)!==0&&I===0?u:null;if(g){for(T=0;T<we;T+=1)ie[T].a?.measure();for(T=0;T<we;T+=1)ie[T].a?.fix()}$a(r,ie,ge)}}g&&va(()=>{if(C!==void 0)for(d of C)d.a?.apply()}),n.first=r.first&&r.first.e,n.last=O&&O.e;for(var te of s.values())ca(te.e);s.clear()}function ma(n,a,r,s){(s&At)!==0&&Gt(n.v,a),(s&St)!==0?Gt(n.i,r):n.i=r}function Ut(n,a,r,s,u,k,l,f,A,g,p){var I=(A&At)!==0,J=(A&Sa)===0,D=I?J?_(u,!1,!1):$t(u):u,w=(A&St)===0?l:$t(l),b={i:w,v:D,k,a:null,e:null,prev:r,next:s};try{if(n===null){var O=document.createDocumentFragment();O.append(n=sa())}return b.e=Pt(()=>f(n,D,w,g),tt),b.e.prev=r&&r.e,b.e.next=s&&s.e,r===null?p||(a.first=b):(r.next=b,r.e.next=b.e),s!==null&&(s.prev=b,s.e.prev=b.e),b}finally{}}function Dt(n,a,r){for(var s=n.next?n.next.e.nodes_start:r,u=a?a.e.nodes_start:r,k=n.e.nodes_start;k!==null&&k!==s;){var l=Aa(k);u.before(k),k=l}}function rt(n,a,r){a===null?n.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function Za(n,a,r,s,u){tt&&ra();var k=a.$$slots?.[r],l=!1;k===!0&&(k=a.children,l=!0),k===void 0?u!==null&&u(n):k(n,l?()=>s:s)}function ba(n){var a,r,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var u=n.length;for(a=0;a<u;a++)n[a]&&(r=ba(n[a]))&&(s&&(s+=" "),s+=r)}else for(r in n)n[r]&&(s&&(s+=" "),s+=r);return s}function Ya(){for(var n,a,r=0,s="",u=arguments.length;r<u;r++)(n=arguments[r])&&(a=ba(n))&&(s&&(s+=" "),s+=a);return s}function Yt(n){return typeof n=="object"?Ya(n):n??""}function Qa(n,a,r){var s=n==null?"":""+n;return s===""?null:s}function qe(n,a,r,s,u,k){var l=n.__className;if(tt||l!==r||l===void 0){var f=Qa(r);(!tt||f!==n.getAttribute("class"))&&(f==null?n.removeAttribute("class"):a?n.className=f:n.setAttribute("class",f)),n.__className=r}return k}const Xa=()=>performance.now(),lt={tick:n=>requestAnimationFrame(n),now:()=>Xa(),tasks:new Set};function xa(){const n=lt.now();lt.tasks.forEach(a=>{a.c(n)||(lt.tasks.delete(a),a.f())}),lt.tasks.size!==0&&lt.tick(xa)}function er(n){let a;return lt.tasks.size===0&&lt.tick(xa),{promise:new Promise(r=>{lt.tasks.add(a={c:n,f:r})}),abort(){lt.tasks.delete(a)}}}function Ct(n,a){fa(()=>{n.dispatchEvent(new CustomEvent(a))})}function tr(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const a=n.split("-");return a.length===1?a[0]:a[0]+a.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function Qt(n){const a={},r=n.split(";");for(const s of r){const[u,k]=s.split(":");if(!u||k===void 0)break;const l=tr(u.trim());a[l]=k.trim()}return a}const ar=n=>n;function Xt(n,a,r,s){var u=(n&Fa)!==0,k="both",l,f=a.inert,A=a.style.overflow,g,p;function I(){return fa(()=>l??=r()(a,s?.()??{},{direction:k}))}var J={is_global:u,in(){a.inert=f,Ct(a,"introstart"),g=Kt(a,I(),p,1,()=>{Ct(a,"introend"),g?.abort(),g=l=void 0,a.style.overflow=A})},out(O){a.inert=!0,Ct(a,"outrostart"),p=Kt(a,I(),g,0,()=>{Ct(a,"outroend"),O?.()})},stop:()=>{g?.abort(),p?.abort()}},D=da;if((D.transitions??=[]).push(J),wa){var w=u;if(!w){for(var b=D.parent;b&&(b.f&Da)!==0;)for(;(b=b.parent)&&(b.f&Ra)===0;);w=!b||(b.f&Ba)!==0}w&&Pa(()=>{$(()=>J.in())})}}function Kt(n,a,r,s,u){var k=s===1;if(Ua(a)){var l,f=!1;return va(()=>{if(!f){var O=a({direction:k?"in":"out"});l=Kt(n,O,r,s,u)}}),{abort:()=>{f=!0,l?.abort()},deactivate:()=>l.deactivate(),reset:()=>l.reset(),t:()=>l.t()}}if(r?.deactivate(),!a?.duration)return u(),{abort:kt,deactivate:kt,reset:kt,t:()=>s};const{delay:A=0,css:g,tick:p,easing:I=ar}=a;var J=[];if(k&&r===void 0&&(p&&p(0,1),g)){var D=Qt(g(0,1));J.push(D,D)}var w=()=>1-s,b=n.animate(J,{duration:A,fill:"forwards"});return b.onfinish=()=>{b.cancel();var O=r?.t()??1-s;r?.abort();var C=s-O,L=a.duration*Math.abs(C),F=[];if(L>0){var V=!1;if(g)for(var j=Math.ceil(L/16.666666666666668),d=0;d<=j;d+=1){var T=O+C*I(d/j),R=Qt(g(T,1-T));F.push(R),V||=R.overflow==="hidden"}V&&(n.style.overflow="hidden"),w=()=>{var oe=b.currentTime;return O+C*I(oe/L)},p&&er(()=>{if(b.playState!=="running")return!1;var oe=w();return p(oe,1-oe),!0})}b=n.animate(F,{duration:L,fill:"forwards"}),b.onfinish=()=>{w=()=>s,p?.(s,1-s),u()}},{abort:()=>{b&&(b.cancel(),b.effect=null,b.onfinish=kt)},deactivate:()=>{u=kt},reset:()=>{s===0&&p?.(1,0)},t:()=>w()}}function Ze(n,a,r=a){var s=new WeakSet;Ka(n,"input",async u=>{var k=u?n.defaultValue:n.value;if(k=Rt(n)?Bt(k):k,r(k),ht!==null&&s.add(ht),await Ha(),k!==(k=a())){var l=n.selectionStart,f=n.selectionEnd;n.value=k??"",f!==null&&(n.selectionStart=l,n.selectionEnd=Math.min(f,n.value.length))}}),(tt&&n.defaultValue!==n.value||$(a)==null&&n.value)&&(r(Rt(n)?Bt(n.value):n.value),ht!==null&&s.add(ht)),Ja(()=>{var u=a();if(n===document.activeElement){var k=Va??ht;if(s.has(k))return}Rt(n)&&u===Bt(n.value)||n.type==="date"&&!u&&!n.value||u!==n.value&&(n.value=u??"")})}function Rt(n){var a=n.type;return a==="number"||a==="range"}function Bt(n){return n===""?null:+n}function ea(n){return function(...a){var r=a[0];return r.stopPropagation(),n?.apply(this,a)}}function rr(n,a){var r=n.$$events?.[a.type],s=ia(r)?r.slice():r==null?[]:[r];for(var u of s)u.call(this,a)}const nr=n=>n;function ta(n,{delay:a=0,duration:r=400,easing:s=nr}={}){const u=+getComputedStyle(n).opacity;return{delay:a,duration:r,easing:s,css:k=>`opacity: ${k*u}`}}var or=E('<div class="fixed inset-0 bg-black/40 z-[900]" role="button" tabindex="0" aria-label="Close model selection"></div>'),ir=E('<div class="px-3 py-2 text-sm text-zinc-400">No matches</div>'),sr=E('<button type="button" role="option"> </button>'),lr=E('<div class="absolute left-0 right-0 mt-1 bg-zinc-800 border border-none rounded shadow-lg z-[960] max-h-60 flex flex-col" id="model-select-menu"><div class="p-2"><div class="flex items-center gap-2 bg-zinc-850 border-none border-zinc-700 px-2 py-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" aria-hidden="true" class="w-4 h-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg> <input type="text" class="w-full bg-transparent border-none text-sm text-zinc-100 focus:outline-none" placeholder="Search models…"/></div></div> <div class="max-h-48 overflow-auto px-4 pb-1" role="listbox" tabindex="-1"><!></div></div>'),cr=E('<p class="p-4 text-sm text-zinc-400">No matches</p>'),dr=ga('<svg class="w-4 h-4 text-zinc-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M16.704 5.29a1 1 0 010 1.42l-7.5 7.5a1 1 0 01-1.414 0l-3.5-3.5a1 1 0 011.414-1.42L8.5 11.086l6.793-6.794a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>'),ur=E('<li><button type="button"><span class="truncate"> </span> <!></button></li>'),vr=E('<ul class="divide-y divide-zinc-900"></ul>'),fr=E('<div class="fixed inset-0 z-[960] bg-black/70 backdrop-blur-sm flex flex-col" role="dialog" aria-modal="true"><div class="mt-8 p-4 bg-zinc-900 border-b border-zinc-800 space-y-3 shadow-lg"><div class="flex items-center justify-between"><h2 class="text-sm font-medium text-zinc-100">Select Model</h2> <button type="button" class="px-3 py-2 rounded bg-zinc-800 hover:bg-zinc-700 text-sm text-zinc-200">Close</button></div> <div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" aria-hidden="true" class="w-4 h-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg> <input type="text" class="flex-1 bg-zinc-800 border border-zinc-700 rounded px-3 py-2 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-zinc-500/40" placeholder="Search models…"/></div></div> <div class="flex-1 overflow-auto bg-zinc-950"><!></div></div>'),pr=E('<!> <div class="flex items-center gap-3 w-full sm:w-full sm:max-w-[50vw] relative z-[950]"><div class="relative flex-1 min-w-0"><button type="button" class="flex w-full items-center gap-2 text-lg text-zinc-100 focus:outline-none bg-transparent border-0 p-0 cursor-pointer" aria-haspopup="listbox" aria-controls="model-select-menu"><span> </span> <svg class="w-5 h-5 text-zinc-400 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button> <!></div></div> <!>',1);function gr(n,a){wt(a,!1);let r=ue(a,"model",12,""),s=ue(a,"models",24,()=>[]),u=ue(a,"modelsLoading",8,!1),k=ue(a,"modelsError",8,""),l=ue(a,"onModelChange",8,()=>{}),f=_(!1),A=_(-1),g=_(null),p=_(null),I=_(null);const J=32;let D=_(""),w=_(""),b=_([]),O=_(""),C=_(!1),L=null,F=null;function V(){u()||s().length===0||(t(f,!e(f)),e(f)&&T())}function j(){t(f,!1),t(A,-1)}function d(h){if(!h||h===r()){j();return}r(h),l()(h),j()}function T(){if(!e(b).length){t(A,-1);return}const h=e(b).indexOf(r());t(A,h===-1?0:h),fe(!0),queueMicrotask(()=>e(I)&&e(I).focus())}function R(h){s().length&&(h.key==="Enter"||h.key===" "?(h.preventDefault(),V()):h.key==="ArrowDown"||h.key==="ArrowUp"?(h.preventDefault(),e(f)?xe(h.key==="ArrowDown"?1:-1):(t(f,!0),t(A,h.key==="ArrowDown"?0:e(b).length-1),fe(!0))):h.key==="Escape"&&j())}function oe(h){h.key==="ArrowDown"||h.key==="ArrowUp"?(h.preventDefault(),xe(h.key==="ArrowDown"?1:-1)):h.key==="Enter"||h.key===" "?(h.preventDefault(),e(A)!==-1&&d(e(b)[e(A)])):h.key==="Escape"&&(h.preventDefault(),j())}function xe(h){e(b).length&&(t(A,(e(A)+h+e(b).length)%e(b).length),fe())}function fe(h=!1){if(!e(g)||e(A)<0)return;const Q=e(A)*J,be=Q+J,Ce=e(g).scrollTop,Ke=Ce+e(g).clientHeight;h||Q<Ce?Lt(g,e(g).scrollTop=Q):be>Ke&&Lt(g,e(g).scrollTop=be-e(g).clientHeight)}function de(h){if(e(C)||!e(p))return;const Q=h.target;(!(Q instanceof Node)||!e(p).contains(Q))&&j()}function K(h){(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),j())}function H(h){e(f)&&h.key==="Escape"&&j()}function ie(h){t(C,h.matches)}Ht(()=>{typeof document>"u"||(document.addEventListener("mousedown",de),document.addEventListener("focusin",de),typeof window<"u"&&typeof window.matchMedia=="function"&&(L=window.matchMedia("(max-width: 640px)"),ie(L),F=h=>ie(h),typeof L.addEventListener=="function"?L.addEventListener("change",F):typeof L.addListener=="function"&&L.addListener(F)))}),Jt(()=>{typeof document>"u"||(document.removeEventListener("mousedown",de),document.removeEventListener("focusin",de),L&&F&&(typeof L.removeEventListener=="function"?L.removeEventListener("change",F):typeof L.removeListener=="function"&&L.removeListener(F)))});function we(h){const Q=h.target;t(D,Q instanceof HTMLInputElement?Q.value:""),t(A,e(b).length?0:-1),fe(!0)}Me(()=>(ne(u()),ne(r()),ne(s()),ne(k())),()=>{t(w,u()?"Loading models…":r()||s()[0]||k()||"No models available")}),Me(()=>e(f),()=>{e(f)||t(D,"")}),Me(()=>(e(D),ne(s())),()=>{t(b,e(D)?s().filter(h=>h.toLowerCase().includes(e(D).toLowerCase())):s())}),Me(()=>e(w),()=>{t(O,e(w).length>20?`${e(w).slice(0,19)}…`:e(w))}),Mt(),_t();var ge=pr();N("keydown",pa,H);var te=_e(ge);{var Ue=h=>{var Q=or();N("click",Q,j),N("keydown",Q,K),Xt(3,Q,()=>ta,()=>({duration:150})),m(h,Q)};P(te,h=>{e(f)&&!e(C)&&h(Ue)})}var Ee=v(te,2),ke=i(Ee),Ne=i(ke),We=i(Ne),Je=i(We,!0);o(We),qt(2),o(Ne);var Ve=v(Ne,2);{var dt=h=>{var Q=lr(),be=i(Q),Ce=i(be),Ke=v(i(Ce),2);nt(Ke),pt(Ke,Oe=>t(I,Oe),()=>e(I)),o(Ce),o(be);var He=v(be,2),Le=i(He);{var Qe=Oe=>{var at=ir();m(Oe,at)},vt=Oe=>{var at=Ye(),Te=_e(at);ct(Te,1,()=>e(b),mt,($e,y,M)=>{var U=sr(),c=i(U,!0);o(U),Y(()=>{qe(U,1,`w-full text-left px-3 py-2 text-sm bg-transparent border-0 cursor-pointer rounded-md transition-colors ${e(A)===M?"bg-zinc-700 text-white":"text-zinc-100 hover:bg-zinc-800/80 hover:text-white"}`),ot(U,"aria-selected",r()===e(y)),re(c,e(y))}),N("mouseenter",U,()=>t(A,M)),N("click",U,()=>d(e(y))),m($e,U)}),m(Oe,at)};P(Le,Oe=>{e(b),$(()=>e(b).length===0)?Oe(Qe):Oe(vt,!1)})}o(He),pt(He,Oe=>t(g,Oe),()=>e(g)),o(Q),Y(()=>Wa(Ke,e(D))),N("input",Ke,we),N("keydown",He,oe),Xt(3,Q,()=>ta,()=>({duration:120})),m(h,Q)};P(Ve,h=>{e(f)&&!e(C)&&h(dt)})}o(ke),o(Ee),pt(Ee,h=>t(p,h),()=>e(p));var ut=v(Ee,2);{var it=h=>{var Q=fr(),be=i(Q),Ce=i(be),Ke=v(i(Ce),2);o(Ce);var He=v(Ce,2),Le=v(i(He),2);nt(Le),pt(Le,Te=>t(I,Te),()=>e(I)),o(He),o(be);var Qe=v(be,2),vt=i(Qe);{var Oe=Te=>{var $e=cr();m(Te,$e)},at=Te=>{var $e=vr();ct($e,5,()=>e(b),mt,(y,M,U)=>{var c=ur(),x=i(c),S=i(x),G=i(S,!0);o(S);var X=v(S,2);{var z=B=>{var ve=dr();m(B,ve)};P(X,B=>{r()===e(M)&&B(z)})}o(x),o(c),Y(()=>{qe(x,1,`w-full px-4 py-3 text-left text-sm flex items-center justify-between ${e(A)===U?"bg-zinc-700 text-white":"text-zinc-200 hover:bg-zinc-900"}`),re(G,e(M))}),N("mouseenter",x,()=>t(A,U)),N("click",x,()=>d(e(M))),m(y,c)}),o($e),m(Te,$e)};P(vt,Te=>{e(b),$(()=>e(b).length===0)?Te(Oe):Te(at,!1)})}o(Qe),pt(Qe,Te=>t(g,Te),()=>e(g)),o(Q),N("click",Ke,j),Ze(Le,()=>e(D),Te=>t(D,Te)),m(h,Q)};P(ut,h=>{e(f)&&e(C)&&h(it)})}Y(()=>{ot(Ne,"aria-expanded",e(f)),Ne.disabled=(ne(u()),ne(s()),ne(k()),$(()=>u()||!s().length&&!k())),qe(We,1,`truncate ${k()?"text-red-300":""}`),re(Je,e(O))}),N("click",Ne,V),N("keydown",Ne,R),m(n,ge),yt()}var mr=E('<header class="sticky top-0 bg-zinc-900 p-4 flex flex-wrap items-center justify-between gap-4 z-[1000]"><div class="flex items-center gap-3 flex-1 min-w-0"><a href="/" class="flex items-center group" aria-label="OpenLang home"><img src="/images/openlang.svg" alt="OpenLang" class="h-7 w-auto group-hover:animate-tilt-shake"/></a> <!></div> <button type="button" class="px-2 py-2 bg-transparent rotate-90 rounded-lg flex items-center gap-2 transition-colors hover:bg-zinc-600/60"><img src="/images/preferences.svg" alt="Open Preferences" class="h-6 w-auto"/></button></header>');function br(n,a){wt(a,!1);let r=ue(a,"model",12,""),s=ue(a,"models",24,()=>[]),u=ue(a,"modelsLoading",8,!1),k=ue(a,"modelsError",8,""),l=ue(a,"onModelChange",8,()=>{});const f=Vt();function A(){f("togglePrefs")}_t();var g=mr(),p=i(g),I=v(i(p),2);gr(I,{get models(){return s()},get modelsLoading(){return u()},get modelsError(){return k()},get onModelChange(){return l()},get model(){return r()},set model(D){r(D)},$$legacy:!0}),o(p);var J=v(p,2);o(g),N("click",J,A),m(n,g),yt()}var xr=E('<div class="text-sm text-red-400"> </div>'),hr=E('<div class="flex flex-col gap-4 flex-1 overflow-y-auto md:max-h-80 md:min-h-60 md:pr-1"><label class="flex flex-col gap-1" for="prefBaseUrl"><span class="text-sm text-zinc-300">LM Studio Base URL</span> <input id="prefBaseUrl" type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="http://localhost:1234"/></label> <label class="flex flex-col gap-1" for="prefApiKey"><span class="text-sm text-zinc-300">API Key (optional)</span> <input id="prefApiKey" type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="Bearer token"/></label> <label class="flex flex-col gap-1" for="prefTemp"><span class="text-sm text-zinc-300">Temperature</span> <input id="prefTemp" type="number" step="0.1" min="0" max="2" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40"/></label> <!></div>'),_r=E('<span class="text-xs text-emerald-400 uppercase">Romanization</span>'),wr=E('<button type="button" class="p-2 rounded-md text-red-400 hover:bg-red-500/10 transition-colors cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"></path><path d="M10 11v6"></path><path d="M14 11v6"></path><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"></path></svg></button>'),yr=E('<div class="flex items-center justify-between bg-zinc-900/60 rounded-lg px-3 py-2 transition-colors cursor-pointer hover:bg-zinc-800" role="button" tabindex="0"><div><div class="text-sm font-medium text-zinc-100"> </div> <div class="text-xs uppercase tracking-wide text-zinc-500"> </div></div> <div class="flex items-center gap-3"><!> <button type="button" class="p-2 rounded-md text-zinc-300 hover:bg-zinc-700/70 transition-colors cursor-pointer"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4Z"></path></svg></button> <!></div></div>'),zr=E('<div class="flex flex-col gap-4 flex-1 overflow-y-auto md:max-h-80 md:min-h-60 md:pr-1"><div class="flex items-center justify-between"><div><h3 class="text-sm font-medium text-zinc-100">Manage Languages</h3> <p class="text-xs text-zinc-400">Edit, add or remove languages.</p></div> <button type="button" class="flex items-center gap-2 px-2 py-1 rounded bg-zinc-800 hover:bg-zinc-700 text-sm cursor-pointer" aria-label="Add languages"><span class="text-lg leading-none">+</span> <span>Add</span></button></div> <div class="flex flex-col gap-2"></div></div>'),kr=E('<div class="text-sm text-red-400"> </div>'),Lr=E('<div class="border border-zinc-800 bg-zinc-900/70 rounded-lg p-4 flex flex-col gap-3"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Name</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="e.g. Klingon" autocomplete="off"/></label> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Code</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40" placeholder="e.g. tlh" autocomplete="off"/></label></div> <div class="flex items-center justify-between bg-zinc-900 px-3 py-2 rounded-lg border border-zinc-800"><div><div class="text-sm font-medium text-zinc-100">Romanization</div> <div class="text-xs text-zinc-500">Toggle if transliteration output is desired.</div></div> <button type="button"> </button></div> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Custom Prompt (optional)</span> <textarea rows="3" class="w-full p-3 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 resize-none" placeholder="Add any instructions for this language"></textarea></label> <!> <div class="flex justify-end gap-2"><button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Cancel</button> <button type="button" class="px-3 py-1 rounded bg-blue-600 hover:bg-blue-500 text-white cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"> </button></div></div>'),Tr=E('<div class="text-sm text-red-400"> </div>'),Er=E('<div class="text-sm text-zinc-400">Loading…</div>'),Cr=E('<div class="flex items-center justify-between bg-zinc-900/60 rounded-lg px-3 py-2"><div><div class="text-sm font-medium text-zinc-100"> </div> <div class="text-xs uppercase tracking-wide text-zinc-500"> </div></div> <button type="button" class="p-2 rounded-md text-emerald-400 hover:bg-zinc-800/70 transition-colors cursor-pointer"><svg viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"></path><path d="M5 12h14"></path></svg></button></div>'),Sr=E('<div class="flex flex-col gap-2"></div>'),Ar=E('<div class="text-sm text-zinc-400">All available languages are already added.</div>'),Mr=E('<div class="flex flex-col gap-4 flex-1 overflow-y-auto md:max-h-80 md:min-h-60 md:pr-1"><div class="flex items-center justify-between gap-3"><div><h3 class="text-sm font-medium text-zinc-100">Add Languages</h3> <p class="text-xs text-zinc-400">Choose additional languages from the library or create your own.</p></div> <div class="flex items-center gap-2"><button type="button" class="px-2 py-1 rounded bg-zinc-800 hover:bg-zinc-700 text-sm cursor-pointer">Add Custom</button></div></div> <!> <!> <!></div>'),Nr=E('<div class="text-sm text-red-400"> </div>'),Or=E('<div class="flex flex-col gap-5"><div class="space-y-4"><label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Name</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 disabled:opacity-60 disabled:cursor-not-allowed"/></label> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Language Code</span> <input type="text" class="w-full p-2 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 disabled:opacity-60 disabled:cursor-not-allowed"/></label> <div class="flex items-center justify-between bg-zinc-900/60 px-3 py-2 rounded-lg"><div><div class="text-sm font-medium text-zinc-100">Romanization</div> <div class="text-xs text-zinc-500">Enable if you want transliteration output.</div></div> <button type="button"> </button></div> <label class="flex flex-col gap-1"><span class="text-sm text-zinc-300">Custom Prompt</span> <textarea rows="4" class="w-full p-3 bg-zinc-800 rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500/40 resize-none"></textarea></label> <!></div></div>'),jr=E('<p class="text-sm text-zinc-400">Select a language to edit.</p>'),Ir=E('<button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600 cursor-pointer">Cancel</button> <button type="button" class="px-3 py-1 rounded border border-blue-500 text-blue-400 hover:bg-blue-500/10 disabled:opacity-50 disabled:cursor-not-allowed"> </button>',1),Dr=E('<button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600">Close</button>'),Rr=E('<button type="button" class="px-3 py-1 border border-zinc-700 rounded text-zinc-200 hover:bg-zinc-800/60 cursor-pointer">Back to list</button> <button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600">Close</button>',1),Br=E('<button type="button" class="px-3 py-1 border border-zinc-700 rounded text-zinc-200 hover:bg-zinc-800/60 cursor-pointer">Back</button> <button type="button" class="flex items-center gap-2 px-2 py-1 rounded bg-zinc-800 hover:bg-zinc-700 text-sm cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"> </button>',1),Pr=E('<div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-start md:items-center justify-center" role="button" tabindex="0" aria-label="Close preferences"><div class="bg-zinc-900 text-zinc-100 w-full h-full md:h-auto md:max-w-3xl md:rounded-xl shadow-xl md:p-6 p-4 overflow-hidden flex flex-col" role="dialog" aria-modal="true" tabindex="0"><h2 class="text-xl font-semibold mb-4 md:mb-6">Preferences</h2> <div class="mt-3 flex flex-col md:flex-row gap-6 overflow-y-auto flex-1"><nav class="flex md:flex-col gap-2 md:w-48 md:sticky md:top-0 bg-zinc-900 md:bg-transparent pb-4 md:pb-0"><button type="button">Connections</button> <button type="button">Languages</button></nav> <section class="flex-1 min-h-[18rem] pb-20 md:pb-0"><!></section></div> <div class="mt-4 md:mt-6 flex justify-end gap-2"><!></div></div></div>');function Fr(n,a){wt(a,!1);let r=ue(a,"baseUrl",12,""),s=ue(a,"apiKey",12,""),u=ue(a,"temperature",12,.2),k=ue(a,"languages",24,()=>[]);const l=Vt();let f=_("connections"),A=_(null),g=_(""),p=_({name:"",code:"",romanize:!1,prompt:""}),I=_(""),J=_(!1),D=_([]),w=_(!1),b=_(""),O=_(!1),C=_(""),L=_(""),F=_(!1),V=_(""),j=_(""),d=_(!1),T=_(""),R=_(!1);function oe(){l("close")}async function xe(){t(T,"");const c=r().trim(),x=typeof u()=="number"?u():Number(u());if(!c){t(T,"Base URL is required.");return}if(!Number.isFinite(x)){t(T,"Temperature must be a number.");return}r(c),u(x),t(R,!0);try{const S=await fetch("/api/connections",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({base_url:c,api_key:s(),temperature:x})});if(!S.ok){const G=await S.json().catch(()=>({}));throw new Error(G.error||S.statusText)}l("save")}catch(S){t(T,S instanceof Error?S.message:"Failed to save connections.")}finally{t(R,!1)}}function fe(c){c.target===c.currentTarget&&oe()}function de(c){if(c.key==="Escape"){oe();return}c.target===c.currentTarget&&(c.key==="Enter"||c.key===" ")&&oe()}function K(c){c.key==="Escape"&&oe()}function H(){t(C,""),t(L,""),t(F,!1),t(V,""),t(j,""),t(d,!1)}function ie(c){t(f,c),c!=="language-edit"&&(t(A,null),t(I,"")),c!=="languages-add"&&(t(O,!1),H()),c==="languages-add"&&Ee()}function we(c){t(A,c),t(g,c.code),t(p,{...c}),t(I,""),t(f,"language-edit")}function ge(){t(p,{...e(p),romanize:!e(p).romanize})}function te(){t(A,null),t(I,""),t(f,"languages")}async function Ue(){if(e(A)){t(I,""),t(J,!0);try{const c=await fetch(`/api/languages/${encodeURIComponent(e(g))}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e(p).name.trim(),code:e(p).code.trim(),romanize:e(p).romanize,prompt:e(p).prompt})});if(!c.ok){const x=await c.json().catch(()=>({}));throw new Error(x.error||c.statusText)}l("languagesUpdated"),te()}catch(c){t(I,c instanceof Error?c.message:"Failed to update language.")}finally{t(J,!1)}}}async function Ee(){if(!e(w)){t(w,!0),t(b,"");try{const c=await fetch("/api/languages/addable"),x=await c.json();if(!c.ok)throw new Error(x.error||"Failed to load languages");t(D,x.languages||[])}catch(c){t(b,c instanceof Error?c.message:"Failed to load languages")}finally{t(w,!1)}}}function ke(){ie("languages-add")}function Ne(){H(),t(O,!0)}function We(){H(),t(O,!1)}function Je(){t(F,!e(F))}function Ve(c){return c.replace(/[^A-Za-z0-9-]/g,"")}function dt(c){const x=c.currentTarget,S=Ve(x.value);x.value!==S&&(x.value=S),t(C,S)}function ut(c){const x=c.currentTarget,S=Ve(x.value);x.value!==S&&(x.value=S),t(L,S)}async function it(){const c=Ve(e(C)),x=Ve(e(L));c!==e(C)&&t(C,c),x!==e(L)&&t(L,x);const S=e(C).trim(),G=e(L).trim(),X=e(V);if(!S||!G){t(j,"Name and code are required.");return}t(j,""),t(d,!0);try{const z=await fetch("/api/languages/add-custom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:S,code:G,romanize:e(F),prompt:X})}),B=await z.json().catch(()=>({}));if(!z.ok)throw new Error(B.error||"Failed to add language.");l("languagesUpdated"),await Ee(),H(),t(O,!1)}catch(z){t(j,z instanceof Error?z.message:"Failed to add language.")}finally{t(d,!1)}}async function h(c){try{const x=await fetch(`/api/languages/add/${encodeURIComponent(c)}`,{method:"POST"});if(!x.ok){const S=await x.json().catch(()=>({}));throw new Error(S.error||"Failed to add language")}l("languagesUpdated"),t(D,e(D).filter(S=>S.code!==c)),e(f)==="languages-add"&&Ee()}catch(x){t(b,x instanceof Error?x.message:"Failed to add language")}}async function Q(c){if(c)try{const x=await fetch(`/api/languages/${encodeURIComponent(c)}`,{method:"DELETE"});if(!x.ok){const S=await x.json().catch(()=>({}));throw new Error(S.error||"Failed to remove language")}l("languagesUpdated"),e(f)==="languages-add"&&Ee()}catch(x){t(I,x instanceof Error?x.message:"Failed to remove language")}}_t();var be=Pr();N("keydown",pa,K);var Ce=i(be),Ke=v(i(Ce),2),He=i(Ke),Le=i(He),Qe=v(Le,2);o(He);var vt=v(He,2),Oe=i(vt);{var at=c=>{var x=hr(),S=i(x),G=v(i(S),2);nt(G),o(S);var X=v(S,2),z=v(i(X),2);nt(z),o(X);var B=v(X,2),ve=v(i(B),2);nt(ve),o(B);var je=v(B,2);{var Se=se=>{var W=xr(),pe=i(W,!0);o(W),Y(()=>re(pe,e(T))),m(se,W)};P(je,se=>{e(T)&&se(Se)})}o(x),Ze(G,r),Ze(z,s),Ze(ve,u),m(c,x)},Te=c=>{var x=Ye(),S=_e(x);{var G=z=>{var B=zr(),ve=i(B),je=v(i(ve),2);o(ve);var Se=v(ve,2);ct(Se,5,k,mt,(se,W)=>{var pe=yr(),Z=i(pe),le=i(Z),ye=i(le,!0);o(le);var Ie=v(le,2),Ae=i(Ie,!0);o(Ie),o(Z);var Ge=v(Z,2),Be=i(Ge);{var ze=ee=>{var me=_r();m(ee,me)};P(Be,ee=>{e(W),$(()=>e(W).romanize)&&ee(ze)})}var ce=v(Be,2),q=v(ce,2);{var ae=ee=>{var me=wr();Y(()=>ot(me,"aria-label",(e(W),$(()=>`Remove ${e(W).name}`)))),N("click",me,ea(()=>Q(e(W).code))),m(ee,me)};P(q,ee=>{e(W),$(()=>e(W).code!=="auto")&&ee(ae)})}o(Ge),o(pe),Y(()=>{re(ye,(e(W),$(()=>e(W).name))),re(Ae,(e(W),$(()=>e(W).code))),ot(ce,"aria-label",(e(W),$(()=>`Edit ${e(W).name}`)))}),N("click",ce,()=>we(e(W))),N("click",pe,()=>we(e(W))),N("keydown",pe,ee=>(ee.key==="Enter"||ee.key===" ")&&we(e(W))),m(se,pe)}),o(Se),o(B),N("click",je,ke),m(z,B)},X=z=>{var B=Ye(),ve=_e(B);{var je=se=>{var W=Mr(),pe=i(W),Z=v(i(pe),2),le=i(Z);o(Z),o(pe);var ye=v(pe,2);{var Ie=q=>{var ae=Lr(),ee=i(ae),me=i(ee),he=v(i(me),2);nt(he),o(me);var De=v(me,2),Pe=v(i(De),2);nt(Pe),o(De),o(ee);var Xe=v(ee,2),Fe=v(i(Xe),2),gt=i(Fe,!0);o(Fe),o(Xe);var st=v(Xe,2),Re=v(i(st),2);Ft(Re),o(st);var ft=v(st,2);{var bt=et=>{var Nt=kr(),_a=i(Nt,!0);o(Nt),Y(()=>re(_a,e(j))),m(et,Nt)};P(ft,et=>{e(j)&&et(bt)})}var Tt=v(ft,2),xt=i(Tt),Et=v(xt,2),ha=i(Et,!0);o(Et),o(Tt),o(ae),Y(et=>{qe(Fe,1,`px-3 py-1 rounded-full text-sm transition-colors ${e(F)?"bg-emerald-500 text-white":"bg-zinc-700 text-zinc-300"}`),re(gt,e(F)?"On":"Off"),xt.disabled=e(d),Et.disabled=et,re(ha,e(d)?"Saving…":"Save Language")},[()=>(e(d),e(C),e(L),$(()=>e(d)||!e(C).trim()||!e(L).trim()))]),Ze(he,()=>e(C),et=>t(C,et)),N("input",he,dt),Ze(Pe,()=>e(L),et=>t(L,et)),N("input",Pe,ut),N("click",Fe,Je),Ze(Re,()=>e(V),et=>t(V,et)),N("click",xt,We),N("click",Et,it),m(q,ae)};P(ye,q=>{e(O)&&q(Ie)})}var Ae=v(ye,2);{var Ge=q=>{var ae=Tr(),ee=i(ae,!0);o(ae),Y(()=>re(ee,e(b))),m(q,ae)};P(Ae,q=>{e(b)&&q(Ge)})}var Be=v(Ae,2);{var ze=q=>{var ae=Er();m(q,ae)},ce=q=>{var ae=Ye(),ee=_e(ae);{var me=De=>{var Pe=Sr();ct(Pe,5,()=>e(D),Xe=>Xe.code,(Xe,Fe)=>{var gt=Cr(),st=i(gt),Re=i(st),ft=i(Re,!0);o(Re);var bt=v(Re,2),Tt=i(bt,!0);o(bt),o(st);var xt=v(st,2);o(gt),Y(()=>{re(ft,(e(Fe),$(()=>e(Fe).name))),re(Tt,(e(Fe),$(()=>e(Fe).code))),ot(xt,"aria-label",(e(Fe),$(()=>`Add ${e(Fe).name}`)))}),N("click",xt,()=>h(e(Fe).code)),m(Xe,gt)}),o(Pe),m(De,Pe)},he=De=>{var Pe=Ar();m(De,Pe)};P(ee,De=>{e(D),$(()=>e(D).length)?De(me):De(he,!1)},!0)}m(q,ae)};P(Be,q=>{e(w)?q(ze):q(ce,!1)})}o(W),N("click",le,Ne),m(se,W)},Se=se=>{var W=Ye(),pe=_e(W);{var Z=le=>{var ye=Ye(),Ie=_e(ye);{var Ae=Be=>{var ze=Or(),ce=i(ze),q=i(ce),ae=v(i(q),2);nt(ae),o(q);var ee=v(q,2),me=v(i(ee),2);nt(me),o(ee);var he=v(ee,2),De=v(i(he),2),Pe=i(De,!0);o(De),o(he);var Xe=v(he,2),Fe=v(i(Xe),2);Ft(Fe),o(Xe);var gt=v(Xe,2);{var st=Re=>{var ft=Nr(),bt=i(ft,!0);o(ft),Y(()=>re(bt,e(I))),m(Re,ft)};P(gt,Re=>{e(I)&&Re(st)})}o(ce),o(ze),Y(()=>{ae.disabled=e(g)==="auto",me.disabled=e(g)==="auto",qe(De,1,(e(p),$(()=>`px-3 py-1 rounded-full text-sm transition-colors ${e(p).romanize?"bg-emerald-500 text-white":"bg-zinc-700 text-zinc-300"}`))),re(Pe,(e(p),$(()=>e(p).romanize?"On":"Off")))}),Ze(ae,()=>e(p).name,Re=>Lt(p,e(p).name=Re)),Ze(me,()=>e(p).code,Re=>Lt(p,e(p).code=Re)),N("click",De,ge),Ze(Fe,()=>e(p).prompt,Re=>Lt(p,e(p).prompt=Re)),m(Be,ze)},Ge=Be=>{var ze=jr();m(Be,ze)};P(Ie,Be=>{e(A)?Be(Ae):Be(Ge,!1)})}m(le,ye)};P(pe,le=>{e(f)==="language-edit"&&le(Z)},!0)}m(se,W)};P(ve,se=>{e(f)==="languages-add"?se(je):se(Se,!1)},!0)}m(z,B)};P(S,z=>{e(f)==="languages"?z(G):z(X,!1)},!0)}m(c,x)};P(Oe,c=>{e(f)==="connections"?c(at):c(Te,!1)})}o(vt),o(Ke);var $e=v(Ke,2),y=i($e);{var M=c=>{var x=Ir(),S=_e(x),G=v(S,2),X=i(G,!0);o(G),Y(()=>{G.disabled=e(R),re(X,e(R)?"Saving…":"Save")}),N("click",S,oe),N("click",G,xe),m(c,x)},U=c=>{var x=Ye(),S=_e(x);{var G=z=>{var B=Dr();N("click",B,oe),m(z,B)},X=z=>{var B=Ye(),ve=_e(B);{var je=se=>{var W=Rr(),pe=_e(W),Z=v(pe,2);N("click",pe,()=>ie("languages")),N("click",Z,oe),m(se,W)},Se=se=>{var W=Ye(),pe=_e(W);{var Z=le=>{var ye=Br(),Ie=_e(ye),Ae=v(Ie,2),Ge=i(Ae,!0);o(Ae),Y(()=>{Ae.disabled=e(J),re(Ge,e(J)?"Saving…":"Save Changes")}),N("click",Ie,te),N("click",Ae,Ue),m(le,ye)};P(pe,le=>{e(f)==="language-edit"&&le(Z)},!0)}m(se,W)};P(ve,se=>{e(f)==="languages-add"?se(je):se(Se,!1)},!0)}m(z,B)};P(S,z=>{e(f)==="languages"?z(G):z(X,!1)},!0)}m(c,x)};P(y,c=>{e(f)==="connections"?c(M):c(U,!1)})}o($e),o(Ce),o(be),Y(()=>{qe(Le,1,Yt(e(f)==="connections"?"px-3 py-2 rounded-lg bg-zinc-800 text-white text-left":"px-3 py-2 rounded-lg text-zinc-400 hover:bg-zinc-800/60 text-left")),qe(Qe,1,Yt(e(f)==="languages"||e(f)==="languages-add"?"px-3 py-2 rounded-lg bg-zinc-800 text-white text-left":"px-3 py-2 rounded-lg text-zinc-400 hover:bg-zinc-800/60 text-left"))}),N("click",Le,()=>ie("connections")),N("click",Qe,()=>ie("languages")),N("pointerdown",Ce,ea(function(c){rr.call(this,a,c)})),N("click",be,fe),N("keydown",be,de),m(n,be),yt()}var Ur=E('<span class="text-xs uppercase tracking-wide text-zinc-400"> </span>'),Kr=E('<p class="p-4 text-sm text-zinc-400">No languages found.</p>'),Hr=ga('<svg class="w-4 h-4 text-zinc-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M16.704 5.29a1 1 0 010 1.42l-7.5 7.5a1 1 0 01-1.414 0l-3.5-3.5a1 1 0 011.414-1.42L8.5 11.086l6.793-6.794a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>'),Jr=E('<li><button type="button"><div><div class="font-medium"> </div> <div class="text-xs uppercase tracking-wide text-zinc-500"> </div></div> <!></button></li>'),Vr=E('<ul class="divide-y divide-zinc-900"></ul>'),qr=E('<div class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex flex-col" role="dialog" aria-modal="true"><div class="mt-8 p-4 bg-zinc-900 border-b border-zinc-800 space-y-3"><h2 class="text-sm font-medium text-zinc-100"> </h2> <div class="flex items-center gap-2"><input type="text" class="flex-1 px-3 py-2 rounded bg-zinc-800 border border-zinc-700 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-zinc-500/40" placeholder="Search languages"/> <button type="button" class="px-3 py-2 rounded bg-zinc-800 hover:bg-zinc-700 text-sm text-zinc-200">Close</button></div></div> <div class="flex-1 overflow-auto bg-zinc-950"><!></div></div>'),Wr=E('<div class="flex flex-col gap-1"><!> <button type="button" class="flex items-center justify-between w-full px-3 py-2 rounded-lg bg-zinc-800 text-left text-sm text-zinc-100 border border-zinc-700 hover:bg-zinc-700/80 transition-colors"><span class="truncate"> </span> <svg class="w-4 h-4 text-zinc-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button></div> <!>',1);function aa(n,a){wt(a,!1);let r=ue(a,"label",8,""),s=ue(a,"languages",24,()=>[]),u=ue(a,"selectedCode",8,null);const k=Vt();let l=_(!1),f=_(""),A=_(),g=_([]);function p(d){k("select",d),t(l,!1),t(f,"")}function I(){t(l,!0)}function J(){t(l,!1),t(f,"")}Me(()=>(ne(s()),ne(u())),()=>{t(A,s().find(d=>d.code===u()))}),Me(()=>(e(f),ne(s())),()=>{t(g,e(f)?s().filter(d=>{const T=e(f).toLowerCase();return d.name.toLowerCase().includes(T)||d.code.toLowerCase().includes(T)}):s())}),Mt(),_t();var D=Wr(),w=_e(D),b=i(w);{var O=d=>{var T=Ur(),R=i(T,!0);o(T),Y(()=>re(R,r())),m(d,T)};P(b,d=>{r()&&d(O)})}var C=v(b,2),L=i(C),F=i(L,!0);o(L),qt(2),o(C),o(w);var V=v(w,2);{var j=d=>{var T=qr(),R=i(T),oe=i(R),xe=i(oe,!0);o(oe);var fe=v(oe,2),de=i(fe);nt(de);var K=v(de,2);o(fe),o(R);var H=v(R,2),ie=i(H);{var we=te=>{var Ue=Kr();m(te,Ue)},ge=te=>{var Ue=Vr();ct(Ue,5,()=>e(g),Ee=>Ee.code,(Ee,ke)=>{var Ne=Jr(),We=i(Ne),Je=i(We),Ve=i(Je),dt=i(Ve,!0);o(Ve);var ut=v(Ve,2),it=i(ut,!0);o(ut),o(Je);var h=v(Je,2);{var Q=be=>{var Ce=Hr();m(be,Ce)};P(h,be=>{e(ke),ne(u()),$(()=>e(ke).code===u())&&be(Q)})}o(We),o(Ne),Y(()=>{qe(We,1,(e(ke),ne(u()),$(()=>`w-full px-4 py-3 text-left text-sm flex items-center justify-between ${e(ke).code===u()?"bg-zinc-600/20 text-zinc-100":"text-zinc-200 hover:bg-zinc-900"}`))),re(dt,(e(ke),$(()=>e(ke).name))),re(it,(e(ke),$(()=>e(ke).code)))}),N("click",We,()=>p(e(ke).code)),m(Ee,Ne)}),o(Ue),m(te,Ue)};P(ie,te=>{e(g),$(()=>e(g).length===0)?te(we):te(ge,!1)})}o(H),o(T),Y(()=>re(xe,r()||"Select Language")),Ze(de,()=>e(f),te=>t(f,te)),N("click",K,J),m(d,T)};P(V,d=>{e(l)&&d(j)})}Y(()=>re(F,(e(A),$(()=>e(A)?`${e(A).name}`:"Select language")))),N("click",C,I),m(n,D),yt()}var $r=E('<div class="flex items-center gap-2 w-full"><div class="flex-1 min-w-0"><!></div> <button type="button"> </button> <div class="flex-1 min-w-0"><!></div></div>'),Gr=E('<button type="button"> </button>'),Zr=E('<button type="button" class="w-full text-left px-3 py-2 text-sm text-zinc-200 bg-transparent cursor-pointer rounded-md transition-colors duration-150 hover:bg-zinc-700/70 hover:text-white"> </button>'),Yr=E('<div class="absolute left-0 mt-2 min-w-[200px] bg-zinc-900 rounded shadow-lg z-40 max-h-60 overflow-auto p-2" role="listbox"></div>'),Qr=E('<!> <div class="relative"><button type="button" class="px-3 py-1 rounded-md text-sm text-zinc-300 flex items-center gap-1 bg-transparent transition-colors hover:bg-zinc-800/70 hover:text-white" aria-haspopup="listbox"><span>More</span> <svg class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button> <!></div>',1),Xr=E('<button type="button" class="absolute top-2 right-2 h-6 w-6 rounded-full bg-zinc-700/70 text-zinc-200 flex items-center justify-center text-xs hover:bg-zinc-600 transition-colors" aria-label="Clear input">✕</button>'),en=E('<div class="absolute inset-0 px-3 py-2 text-zinc-500 pointer-events-none flex gap-2"><span>Type</span> <img src="/images/slash.svg" alt="Slash key" class="mt-1 h-4 w-4"/> <span>to input</span></div>'),tn=E('<button type="button" class="px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600 text-sm" title="Switch languages">⇄</button>'),an=E('<button type="button"> </button>'),rn=E('<button type="button" class="w-full text-left px-3 py-2 text-sm text-zinc-200 bg-transparent cursor-pointer rounded-md transition-colors duration-150 hover:bg-zinc-700/70 hover:text-white"> </button>'),nn=E('<div class="absolute left-0 mt-2 min-w-[200px] bg-zinc-900 rounded shadow-lg z-40 max-h-60 overflow-auto p-2" role="listbox"></div>'),on=E('<!> <div class="relative"><button type="button" class="px-3 py-1 rounded-md text-sm text-zinc-300 flex items-center gap-1 bg-transparent transition-colors hover:bg-zinc-800/70 hover:text-white" aria-haspopup="listbox"><span>More</span> <svg class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"></path></svg></button> <!></div>',1),sn=E('<div class="text-zinc-400 italic whitespace-pre-wrap"> </div>'),ln=E('<button type="button" class="flex items-center gap-2 rounded-md py-1 text-sm text-zinc-300 transition-colors hover:text-zinc-100"><span> </span> <svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 1 1 1.06 1.06l-4.24 4.24a.75.75 0 0 1-1.06 0L5.21 8.29a.75.75 0 0 1 .02-1.08Z" clip-rule="evenodd"></path></svg></button>'),cn=E('<pre class="whitespace-pre-wrap rounded-md bg-zinc-900/70 px-3 py-2 text-xs leading-relaxed text-zinc-400"> </pre>'),dn=E('<div class="mt-auto space-y-2"><div class="flex items-center gap-2"><!> <button type="button" class="ml-auto p-2 rounded-md text-zinc-300 bg-transparent transition-colors hover:bg-zinc-700/70" aria-label="Copy translation"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div> <!></div>'),un=E('<div class="absolute bottom-3 right-3"><svg class="h-5 w-5 animate-spin text-zinc-400" viewBox="0 0 24 24" fill="none"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v3a5 5 0 00-5 5H4z"></path></svg></div>'),vn=E('<div class="flex flex-col gap-2 h-full"><div class="flex gap-2 flex-wrap items-center relative w-full"><!> <!></div> <div class="relative flex-1 rounded-xl bg-zinc-800 h-full p-3 flex flex-col gap-3 min-h-[14rem]"><div> </div> <!> <!> <!></div></div>'),fn=E('<div class="grid grid-cols-1 lg:grid-cols-2 min-h-[200px] gap-6 relative z-0"><div class="flex flex-col gap-2"><div class="flex gap-2 flex-wrap relative w-full"><!></div> <div class="relative flex-1 w-full min-h-[14rem]"><textarea class="flex-1 rounded-xl bg-zinc-800 p-3 pr-10 h-full resize-none focus:outline-none w-full min-h-[14rem]" aria-label="Input text"></textarea> <!> <!></div></div> <!></div>');function pn(n,a){wt(a,!1);let r=ue(a,"baseUrl",8,"http://localhost:1234"),s=ue(a,"apiKey",8,""),u=ue(a,"model",8,""),k=ue(a,"temperature",8,.2),l=ue(a,"languages",24,()=>[]),f=ue(a,"defaultSource",8,"auto"),A=ue(a,"defaultTarget",8,"zh-CN"),g=_(""),p=_(""),I=_(""),J=_(!1),D=_(!0),w=_(null),b=_(null),O=_(null),C=_(f()),L=_(A()),F=_([f(),"en",A()]),V=_(["en",A(),"ja"]),j=_(!1),d=_(!1),T=_(!1),R=_(!1),oe=_(""),xe=null,fe=_(),de=_(!0),K=_(""),H=_(!1),ie=_(0);function we(){const y=localStorage.getItem("recentSources"),M=localStorage.getItem("recentTargets");if(y)try{const U=JSON.parse(y);Array.isArray(U)&&U.length&&t(F,U)}catch{}if(M)try{const U=JSON.parse(M);Array.isArray(U)&&U.length&&t(V,U)}catch{}e(F).includes("auto")?t(F,["auto",...e(F).filter(U=>U!=="auto")]):t(F,["auto",...e(F)]),t(V,e(V).filter(U=>U!=="auto"))}function ge(){if(!l()||l().length===0)return;const y=l().filter(z=>z.code!=="auto");if(!y.length)return;const M=y.map(z=>z.code),c=e(V).find(z=>M.includes(z))??M[0];if(!c)return;(!M.includes(e(L))||e(L)!==c)&&t(L,c);const x=e(V).filter(z=>z!==c&&M.includes(z)),S=[c,...x];if(S.length<3){for(const z of M)if(S.includes(z)||S.push(z),S.length>=3)break}const G=S.slice(0,3);(G.length!==e(V).length||G.some((z,B)=>z!==e(V)[B]))&&(t(V,G),te())}function te(){localStorage.setItem("recentSources",JSON.stringify(e(F))),localStorage.setItem("recentTargets",JSON.stringify(e(V)))}function Ue(y,M,U=3){if(y==="recentSources"){if(M==="auto"){t(C,"auto");return}t(C,M);const c=e(F).filter(x=>x!=="auto"&&x!==M);t(F,["auto",M,...c].slice(0,U)),te()}else{if(M==="auto")return;t(L,M),t(V,[M,...e(V).filter(c=>c!==M)].slice(0,U)),te()}}function Ee(y){Ue("recentSources",y),t(j,!1),Je()}function ke(y){Ue("recentTargets",y),t(d,!1),Je()}function Ne(){if(e(C)==="auto")return;const y=e(C);t(C,e(L)),t(L,y),Ue("recentSources",e(C)),Ue("recentTargets",e(L)),Je()}function We(){xe&&clearTimeout(xe),t(p,""),t(I,""),t(K,""),t(H,!1),t(ie,0),xe=setTimeout(()=>Je(),700)}async function Je(){if(!e(g).trim()){t(p,""),t(I,""),t(J,!1),t(K,""),t(H,!1),t(ie,0);return}if(!u()){t(p,"Select a model to translate."),t(I,""),t(J,!1),t(K,""),t(H,!1),t(ie,0);return}const y=Date.now();t(J,!0),t(p,"Translating…"),t(I,""),t(K,""),t(H,!1),t(ie,0);try{const M=l().find(B=>B.code===e(L)),U=M?.romanize?M.prompt||"Also include a 'romanization' string that reflects the pronunciation of the translated output text (never the source text).":"Do not include romanization.";let S=(await(await fetch(`${r()}/v1/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",...s()?{Authorization:`Bearer ${s()}`}:{}},body:JSON.stringify({model:u(),temperature:k(),messages:[{role:"system",content:`
You are a professional translator. Preserve tone, punctuation, spacing, and line breaks.
Return ONLY strict JSON (no code fences, no extra text) in this exact shape:
{"output": "translated text", "romanization": "if applicable, otherwise empty string"}.
${U}
`},{role:"user",content:`Translate the following text from ${e(C)} to ${e(L)}.
Text: ${e(g)}`}]})})).json())?.choices?.[0]?.message?.content??"",G="";const X=S.match(/<think>([\s\S]*?)<\/think>/i);X&&(G=X[1].trim(),S=S.replace(X[0],"").trim());let z;try{z=JSON.parse(S)}catch{const B=S.indexOf("{"),ve=S.lastIndexOf("}");if(B!==-1&&ve!==-1&&ve>B)try{z=JSON.parse(S.slice(B,ve+1))}catch{z={output:S,romanization:""}}else z={output:S,romanization:""}}if(t(p,z.output||z.translation||""),t(I,M?.romanize&&z.romanization||""),G){t(K,G);const B=Date.now()-y;t(ie,Math.max(.1,Math.round(B/1e3*10)/10)),t(H,!1)}e(p)||t(p,"⚠️ Translation error (empty output)")}catch(M){console.error(M),t(p,"⚠️ Translation error"),t(I,""),t(K,""),t(H,!1),t(ie,0)}finally{t(J,!1)}}function Ve(y){if(y.key==="Escape"){t(j,!1),t(d,!1);return}if(y.key==="/"&&!y.defaultPrevented&&!y.ctrlKey&&!y.metaKey&&!y.altKey){const M=y.target,U=M instanceof HTMLElement?M.tagName.toLowerCase():"";if(U==="input"||U==="textarea")return;y.preventDefault(),e(w)&&(e(w).focus(),t(D,!1))}}function dt(y){const M=y.target;e(j)&&e(b)&&!(M instanceof Node&&e(b).contains(M))&&t(j,!1),e(d)&&e(O)&&!(M instanceof Node&&e(O).contains(M))&&t(d,!1)}function ut(y){return!y||Number.isNaN(y)?"0":y>=10?Math.round(y).toString():y.toFixed(1)}Ht(()=>{t(R,/mobile|android|iphone|ipad|ipod/i.test(navigator.userAgent||"")),t(oe,e(R)?"Enter text":""),e(R)&&(t(j,!1),t(d,!1)),we(),ge(),l().length&&t(T,!0),window.addEventListener("keydown",Ve),window.addEventListener("click",dt)}),Jt(()=>{xe&&(clearTimeout(xe),xe=null),window.removeEventListener("keydown",Ve),window.removeEventListener("click",dt)}),Me(()=>ne(u()),()=>{t(fe,u())}),Me(()=>(e(fe),ne(u()),e(g)),()=>{e(fe)!==void 0&&u()!==e(fe)&&e(g).trim()&&u()&&Je()}),Me(()=>(e(T),ne(l())),()=>{!e(T)&&l().length&&(ge(),t(T,!0))}),Me(()=>(e(T),ne(l()),e(L)),()=>{e(T)&&l().length&&!l().some(y=>y.code===e(L)&&y.code!=="auto")&&ge()}),Me(()=>(e(R),e(g)),()=>{t(de,!e(R)||!!e(g))}),Mt(),_t();var it=fn(),h=i(it),Q=i(h),be=i(Q);{var Ce=y=>{var M=$r(),U=i(M),c=i(U);aa(c,{get languages(){return l()},get selectedCode(){return e(C)},$$events:{select:z=>Ee(z.detail)}}),o(U);var x=v(U,2),S=i(x,!0);o(x);var G=v(x,2),X=i(G);{let z=na(()=>(ne(l()),$(()=>l().filter(B=>B.code!=="auto"))));aa(X,{get languages(){return e(z)},get selectedCode(){return e(L)},$$events:{select:B=>ke(B.detail)}})}o(G),o(M),Y(()=>{qe(x,1,`shrink-0 px-3 py-2 rounded-full text-lg transition-colors ${e(C)==="auto"?"text-zinc-500 cursor-default":"text-zinc-200 hover:text-white"}`),ot(x,"title",e(C)==="auto"?"Switch disabled for Auto":"Switch languages"),x.disabled=e(C)==="auto",re(S,e(C)==="auto"?"→":"⇄")}),N("click",x,()=>e(C)!=="auto"&&Ne()),m(y,M)},Ke=y=>{var M=Qr(),U=_e(M);ct(U,1,()=>e(F),mt,(X,z)=>{var B=Ye(),ve=_e(B);{var je=Se=>{var se=Gr(),W=i(se,!0);o(se),Y(pe=>{qe(se,1,`px-3 py-1 rounded text-sm transition-colors ${e(C)===e(z)?"bg-zinc-800/80 text-white":"bg-transparent text-zinc-300 hover:bg-zinc-800/70 hover:text-white"}`),re(W,pe)},[()=>(ne(l()),e(z),$(()=>l().find(pe=>pe.code===e(z))?.name))]),N("click",se,()=>Ee(e(z))),m(Se,se)};P(ve,Se=>{ne(l()),e(z),$(()=>l().find(se=>se.code===e(z)))&&Se(je)})}m(X,B)});var c=v(U,2),x=i(c),S=v(x,2);{var G=X=>{var z=Yr();ct(z,5,()=>(ne(l()),e(F),$(()=>l().filter(B=>!e(F).includes(B.code)))),mt,(B,ve)=>{var je=Zr(),Se=i(je,!0);o(je),Y(()=>re(Se,(e(ve),$(()=>e(ve).name)))),N("click",je,()=>Ee(e(ve).code)),m(B,je)}),o(z),m(X,z)};P(S,X=>{e(j)&&X(G)})}o(c),pt(c,X=>t(b,X),()=>e(b)),Y(()=>ot(x,"aria-expanded",e(j))),N("click",x,()=>t(j,!e(j))),m(y,M)};P(be,y=>{e(R)?y(Ce):y(Ke,!1)})}o(Q);var He=v(Q,2),Le=i(He);Ft(Le),pt(Le,y=>t(w,y),()=>e(w));var Qe=v(Le,2);{var vt=y=>{var M=Xr();N("click",M,()=>{t(g,""),t(p,""),t(I,""),t(D,!0),t(K,""),t(H,!1),t(ie,0),e(w)?.focus()}),m(y,M)};P(Qe,y=>{e(g)&&y(vt)})}var Oe=v(Qe,2);{var at=y=>{var M=en();m(y,M)};P(Oe,y=>{!e(R)&&e(D)&&!e(g)&&y(at)})}o(He),o(h);var Te=v(h,2);{var $e=y=>{var M=vn(),U=i(M),c=i(U);{var x=Z=>{var le=tn();N("click",le,Ne),m(Z,le)};P(c,Z=>{e(R)||Z(x)})}var S=v(c,2);{var G=Z=>{var le=on(),ye=_e(le);ct(ye,1,()=>e(V),mt,(ze,ce)=>{var q=Ye(),ae=_e(q);{var ee=me=>{var he=an(),De=i(he,!0);o(he),Y(Pe=>{qe(he,1,`px-3 py-1 rounded text-sm transition-colors ${e(L)===e(ce)?"bg-zinc-800/80 text-white":"bg-transparent text-zinc-300 hover:bg-zinc-800/70 hover:text-white"}`),re(De,Pe)},[()=>(ne(l()),e(ce),$(()=>l().find(Pe=>Pe.code===e(ce))?.name??e(ce)))]),N("click",he,()=>ke(e(ce))),m(me,he)};P(ae,me=>{ne(l()),e(ce),$(()=>l().find(he=>he.code===e(ce)&&he.code!=="auto"))&&me(ee)})}m(ze,q)});var Ie=v(ye,2),Ae=i(Ie),Ge=v(Ae,2);{var Be=ze=>{var ce=nn();ct(ce,5,()=>(ne(l()),e(V),$(()=>l().filter(q=>!e(V).includes(q.code)&&q.code!=="auto"))),mt,(q,ae)=>{var ee=rn(),me=i(ee,!0);o(ee),Y(()=>re(me,(e(ae),$(()=>e(ae).name)))),N("click",ee,()=>ke(e(ae).code)),m(q,ee)}),o(ce),m(ze,ce)};P(Ge,ze=>{e(d)&&ze(Be)})}o(Ie),pt(Ie,ze=>t(O,ze),()=>e(O)),Y(()=>ot(Ae,"aria-expanded",e(d))),N("click",Ae,()=>t(d,!e(d))),m(Z,le)};P(S,Z=>{e(R)||Z(G)})}o(U);var X=v(U,2),z=i(X),B=i(z,!0);o(z);var ve=v(z,2);{var je=Z=>{var le=sn(),ye=i(le,!0);o(le),Y(()=>re(ye,e(I))),m(Z,le)};P(ve,Z=>{e(I)&&Z(je)})}var Se=v(ve,2);{var se=Z=>{var le=dn(),ye=i(le),Ie=i(ye);{var Ae=ce=>{var q=ln(),ae=i(q),ee=i(ae,!0);o(ae);var me=v(ae,2);o(q),Y(he=>{ot(q,"aria-expanded",e(H)),re(ee,he),qe(me,0,`h-4 w-4 transition-transform ${e(H)?"rotate-180":""}`)},[()=>(e(H),e(ie),$(()=>e(H)?"Hide thinking":`Thought for ${ut(e(ie))} seconds`))]),N("click",q,()=>t(H,!e(H))),m(ce,q)};P(Ie,ce=>{e(K)&&ce(Ae)})}var Ge=v(Ie,2);o(ye);var Be=v(ye,2);{var ze=ce=>{var q=cn(),ae=i(q,!0);o(q),Y(()=>re(ae,e(K))),m(ce,q)};P(Be,ce=>{e(K)&&e(H)&&ce(ze)})}o(le),N("click",Ge,()=>navigator.clipboard.writeText(e(p)||"")),m(Z,le)};P(Se,Z=>{!e(J)&&e(p)&&Z(se)})}var W=v(Se,2);{var pe=Z=>{var le=un();m(Z,le)};P(W,Z=>{e(J)&&Z(pe)})}o(X),o(M),Y(()=>{qe(z,1,`flex-1 whitespace-pre-wrap ${e(J)?"text-zinc-400 italic":"text-zinc-100"}`),re(B,e(p))}),m(y,M)};P(Te,y=>{e(de)&&y($e)})}o(it),Y(()=>ot(Le,"placeholder",e(oe))),Ze(Le,()=>e(g),y=>t(g,y)),N("input",Le,We),N("focus",Le,()=>t(D,!1)),N("blur",Le,()=>t(D,!e(g))),m(n,it),yt()}var gn=E('<img src="/images/openlang.svg" alt="OpenLang" class="w-32 h-32"/>'),mn=E('<div class="fixed inset-0 z-[1002] flex items-center justify-center bg-black"><!></div>');function bn(n,a){let r=ue(a,"visible",8,!1);var s=Ye(),u=_e(s);{var k=l=>{var f=mn(),A=i(f);Za(A,a,"default",{},g=>{var p=gn();m(g,p)}),o(f),m(l,f)};P(u,l=>{r()&&l(k)})}m(n,s)}var xn=E('<link rel="icon" href="/favicon.ico" sizes="any"/> <link rel="icon" type="image/svg+xml" href="/images/openlang.svg"/> <link rel="apple-touch-icon" href="/apple-touch-icon.png"/>',1),hn=E('<div class="min-h-screen bg-zinc-900 text-zinc-100 flex flex-col"><!> <main class="flex-1 max-w-7xl mx-auto p-6 w-full"><!></main> <!></div> <!>',1);function En(n,a){wt(a,!1);let r=ue(a,"data",8),s=_(r().languages),u=_(r().defaultSource),k=_(r().defaultTarget),l=_(!1),f=_(r().connections.base_url),A=_(r().connections.api_key),g=_(""),p=_(r().connections.temperature??.2),I=_([]),J=_(!1),D=_(""),w=_(!0),b;async function O(){t(J,!0),t(D,"");try{const H=await(await fetch(`${e(f)}/v1/models`,{headers:{"Content-Type":"application/json",...e(A)?{Authorization:`Bearer ${e(A)}`}:{}}})).json(),we=C(H).map(te=>typeof te=="string"?te:te&&typeof te=="object"&&(te.id||te.name||te.model_id||te.slug||te.label)||null).filter(Boolean),ge=Array.from(new Set(we));if(t(I,ge),ge.length===0){t(g,""),t(D,"Please start LM Studio API server.");return}t(D,""),(!e(g)||!ge.includes(e(g)))&&t(g,ge[0])}catch(K){console.error("Failed to load models:",K),t(I,[]),t(g,""),t(D,"Please start LM Studio API server.")}finally{t(J,!1)}}function C(K,H=0){if(!K||H>5)return[];if(Array.isArray(K))return K;if(K&&typeof K=="object"){const ie=K;for(const we of["data","models","items","list","result"]){const ge=ie[we];if(Array.isArray(ge))return ge}for(const we of Object.values(ie)){const ge=C(we,H+1);if(ge.length)return ge}}return[]}function L(K){K.key==="Escape"&&e(l)&&t(l,!1)}Ht(()=>{window.addEventListener("keydown",L),O(),b=window.setTimeout(()=>{t(w,!1)},200)}),Jt(()=>{window.removeEventListener("keydown",L),b&&clearTimeout(b)});async function F(){t(l,!1),await Zt(),O()}async function V(){await Zt()}Me(()=>ne(r()),()=>{t(s,r().languages)}),Me(()=>ne(r()),()=>{t(u,r().defaultSource)}),Me(()=>ne(r()),()=>{t(k,r().defaultTarget)}),Me(()=>ne(r()),()=>{t(f,r().connections.base_url)}),Me(()=>ne(r()),()=>{t(A,r().connections.api_key)}),Me(()=>ne(r()),()=>{t(p,r().connections.temperature??.2)}),Mt(),_t();var j=hn();qa(K=>{var H=xn();qt(4),m(K,H)});var d=_e(j),T=i(d);br(T,{get models(){return e(I)},get modelsLoading(){return e(J)},get modelsError(){return e(D)},get model(){return e(g)},set model(K){t(g,K)},$$events:{togglePrefs:()=>t(l,!e(l))},$$legacy:!0});var R=v(T,2),oe=i(R);pn(oe,{get baseUrl(){return e(f)},get apiKey(){return e(A)},get model(){return e(g)},get temperature(){return e(p)},get languages(){return e(s)},get defaultSource(){return e(u)},get defaultTarget(){return e(k)}}),o(R);var xe=v(R,2);{var fe=K=>{Fr(K,{get languages(){return e(s)},get baseUrl(){return e(f)},set baseUrl(H){t(f,H)},get apiKey(){return e(A)},set apiKey(H){t(A,H)},get temperature(){return e(p)},set temperature(H){t(p,H)},$$events:{close:()=>t(l,!1),save:F,languagesUpdated:V},$$legacy:!0})};P(xe,K=>{e(l)&&K(fe)})}o(d);var de=v(d,2);bn(de,{get visible(){return e(w)}}),m(n,j),yt()}export{En as component};
